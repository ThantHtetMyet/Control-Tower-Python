2025-12-08 15:20:26,202 - __main__ - INFO - 
2025-12-08 15:20:26,203 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-08 15:20:26,206 - __main__ - INFO - 
2025-12-08 15:20:26,206 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-08 15:20:26,207 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-08 15:20:26,208 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-08 15:20:26,208 - __main__ - INFO - Authenticating with API...
2025-12-08 15:20:26,209 - __main__ - INFO - 
2025-12-08 15:20:26,209 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-08 15:20:26,266 - __main__ - INFO - [AUTH] POST https://localhost:7240/api/Auth/signin
2025-12-08 15:20:26,269 - __main__ - INFO - [AUTH] Email: admin@willowglen.com
2025-12-08 15:20:28,558 - __main__ - INFO - 
2025-12-08 15:20:28,559 - __main__ - ERROR - [AUTH] Authentication error: Cannot connect to host localhost:7240 ssl:default [The remote computer refused the network connection]
2025-12-08 15:20:28,560 - __main__ - ERROR - Failed to authenticate with API. Service cannot start.
2025-12-08 15:20:28,560 - __main__ - INFO - 
2025-12-08 15:20:28,561 - __main__ - INFO - Cleaning up resources...
2025-12-08 15:20:28,562 - __main__ - INFO - 
2025-12-08 15:20:28,563 - __main__ - INFO - Cleanup completed
2025-12-08 15:28:49,830 - __main__ - INFO - 
2025-12-08 15:28:49,832 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-08 15:28:49,834 - __main__ - INFO - 
2025-12-08 15:28:49,834 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-08 15:28:49,835 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-08 15:28:49,835 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-08 15:28:49,836 - __main__ - INFO - Authenticating with API...
2025-12-08 15:28:49,836 - __main__ - INFO - 
2025-12-08 15:28:49,837 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-08 15:28:49,916 - __main__ - INFO - [AUTH] POST https://localhost:7240/api/Auth/signin
2025-12-08 15:28:49,916 - __main__ - INFO - [AUTH] Email: admin@willowglen.com
2025-12-08 15:28:52,216 - __main__ - INFO - 
2025-12-08 15:28:52,217 - __main__ - ERROR - [AUTH] Authentication error: Cannot connect to host localhost:7240 ssl:default [The remote computer refused the network connection]
2025-12-08 15:28:52,218 - __main__ - ERROR - Failed to authenticate with API. Service cannot start.
2025-12-08 15:28:52,218 - __main__ - INFO - 
2025-12-08 15:28:52,219 - __main__ - INFO - Cleaning up resources...
2025-12-08 15:28:52,219 - __main__ - INFO - 
2025-12-08 15:28:52,220 - __main__ - INFO - Cleanup completed
2025-12-08 15:29:13,552 - __main__ - INFO - 
2025-12-08 15:29:13,553 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-08 15:29:13,555 - __main__ - INFO - 
2025-12-08 15:29:13,555 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-08 15:29:13,556 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-08 15:29:13,557 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-08 15:29:13,558 - __main__ - INFO - Authenticating with API...
2025-12-08 15:29:13,558 - __main__ - INFO - 
2025-12-08 15:29:13,559 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-08 15:29:13,651 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-08 15:29:13,651 - __main__ - INFO - [AUTH] Email: admin@willowglen.com
2025-12-08 15:29:14,097 - __main__ - INFO - 
2025-12-08 15:29:14,098 - __main__ - INFO - [AUTH] Response Status: 401
2025-12-08 15:29:14,098 - __main__ - INFO - 
2025-12-08 15:29:14,099 - __main__ - ERROR - [AUTH] Authentication failed: Status 401
2025-12-08 15:29:14,100 - __main__ - ERROR - [AUTH] Response: {"message":"Invalid email or password"}
2025-12-08 15:29:14,102 - __main__ - ERROR - Failed to authenticate with API. Service cannot start.
2025-12-08 15:29:14,103 - __main__ - INFO - 
2025-12-08 15:29:14,104 - __main__ - INFO - Cleaning up resources...
2025-12-08 15:29:14,105 - __main__ - INFO - 
2025-12-08 15:29:14,106 - __main__ - INFO - Cleanup completed
2025-12-08 15:29:30,720 - __main__ - INFO - 
2025-12-08 15:29:30,721 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-08 15:29:30,723 - __main__ - INFO - 
2025-12-08 15:29:30,723 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-08 15:29:30,724 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-08 15:29:30,724 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-08 15:29:30,725 - __main__ - INFO - Authenticating with API...
2025-12-08 15:29:30,725 - __main__ - INFO - 
2025-12-08 15:29:30,725 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-08 15:29:30,793 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-08 15:29:30,793 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-08 15:29:31,343 - __main__ - INFO - 
2025-12-08 15:29:31,347 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-08 15:29:31,348 - __main__ - INFO - 
2025-12-08 15:29:31,349 - __main__ - INFO - [AUTH] Authentication successful
2025-12-08 15:29:31,349 - __main__ - INFO - [AUTH] Token expires at: 2025-12-09T07:29:31.3418196Z
2025-12-08 15:29:31,351 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-08 15:29:31,359 - __main__ - INFO - 
2025-12-08 15:29:31,361 - __main__ - INFO - 
2025-12-08 15:29:31,364 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-08 15:29:31,365 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-08 15:29:31,368 - __main__ - INFO - Waiting for MQTT messages...
2025-12-08 15:29:31,381 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-08 15:29:31,383 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-08 15:29:31,385 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-08 15:29:31,387 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-08 15:29:31,388 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-08 15:29:31,389 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-08 16:55:12,513 - __main__ - INFO - 
2025-12-08 16:55:12,514 - __main__ - INFO - Cleaning up resources...
2025-12-09 09:26:13,098 - __main__ - INFO - 
2025-12-09 09:26:13,099 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 09:26:13,100 - __main__ - INFO - 
2025-12-09 09:26:13,100 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 09:26:13,100 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 09:26:13,100 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 09:26:13,101 - __main__ - INFO - Authenticating with API...
2025-12-09 09:26:13,101 - __main__ - INFO - 
2025-12-09 09:26:13,101 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 09:26:13,129 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 09:26:13,130 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 09:26:15,427 - __main__ - INFO - 
2025-12-09 09:26:15,427 - __main__ - ERROR - [AUTH] Authentication error: Cannot connect to host localhost:7145 ssl:default [The remote computer refused the network connection]
2025-12-09 09:26:15,428 - __main__ - ERROR - Failed to authenticate with API. Service cannot start.
2025-12-09 09:26:15,428 - __main__ - INFO - 
2025-12-09 09:26:15,428 - __main__ - INFO - Cleaning up resources...
2025-12-09 09:26:15,428 - __main__ - INFO - 
2025-12-09 09:26:15,429 - __main__ - INFO - Cleanup completed
2025-12-09 10:35:12,062 - __main__ - INFO - 
2025-12-09 10:35:12,063 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 10:35:12,063 - __main__ - INFO - 
2025-12-09 10:35:12,064 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 10:35:12,064 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 10:35:12,064 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 10:35:12,064 - __main__ - INFO - Authenticating with API...
2025-12-09 10:35:12,064 - __main__ - INFO - 
2025-12-09 10:35:12,065 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 10:35:12,089 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 10:35:12,091 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 10:35:12,707 - __main__ - INFO - 
2025-12-09 10:35:12,708 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 10:35:12,709 - __main__ - INFO - 
2025-12-09 10:35:12,709 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 10:35:12,710 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T02:35:12.7031866Z
2025-12-09 10:35:12,711 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 10:35:12,718 - __main__ - INFO - 
2025-12-09 10:35:12,718 - __main__ - INFO - 
2025-12-09 10:35:12,719 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 10:35:12,719 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 10:35:12,720 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 10:35:12,721 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 10:35:12,722 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 10:35:12,722 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 10:35:12,723 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 10:35:12,724 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 10:35:12,724 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 10:36:30,258 - __main__ - INFO - 
2025-12-09 10:36:30,258 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: f9d98bf9-af38-4518-a90d-f8036071b7e8
2025-12-09 10:36:30,259 - __main__ - INFO - [DATA] Message data: {'report_id': 'f9d98bf9-af38-4518-a90d-f8036071b7e8', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T02:36:30.2444739Z', 'report_type': 'cm_final_report'}
2025-12-09 10:36:30,265 - __main__ - INFO - 
2025-12-09 10:36:30,265 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: f9d98bf9-af38-4518-a90d-f8036071b7e8 (cm_reportform_signature_pdf)
2025-12-09 10:36:30,266 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 10:36:30,266 - __main__ - INFO - [STATUS UPDATE] f9d98bf9-af38-4518-a90d-f8036071b7e8 -> PROCESSING - PDF generation started
2025-12-09 10:36:30,267 - __main__ - INFO - [MQTT] Published to topic: controltower/server_pm_reportform_pdf_status/f9d98bf9-af38-4518-a90d-f8036071b7e8
2025-12-09 10:36:30,268 - __main__ - INFO - 
2025-12-09 10:36:30,268 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 10:36:30,268 - __main__ - INFO - 
2025-12-09 10:36:30,269 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 10:36:30,271 - __main__ - INFO - 
2025-12-09 10:36:30,271 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/f9d98bf9-af38-4518-a90d-f8036071b7e8
2025-12-09 10:36:30,272 - __main__ - INFO - 
2025-12-09 10:36:30,272 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/f9d98bf9-af38-4518-a90d-f8036071b7e8
2025-12-09 10:36:30,357 - __main__ - INFO - 
2025-12-09 10:36:30,358 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 10:36:30,359 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 10:36:30,360 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 10:36:30,879 - __main__ - INFO - 
2025-12-09 10:36:30,879 - __main__ - INFO - [API] Response Status: 200
2025-12-09 10:36:30,880 - __main__ - INFO - 
2025-12-09 10:36:30,881 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3811 chars)
2025-12-09 10:36:30,881 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 10:36:30,883 - __main__ - INFO - 
2025-12-09 10:36:30,884 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 10:36:30,903 - __main__ - INFO - 
2025-12-09 10:36:30,904 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 10:36:46,896 - __main__ - ERROR - Error fetching signature images: ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]Named Pipes Provider: Could not open a connection to SQL Server [2].  (2) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (2)')
2025-12-09 10:36:46,897 - __main__ - INFO - [SIGNATURE] Found 0 signature images
2025-12-09 10:36:46,897 - __main__ - INFO - 
2025-12-09 10:36:46,898 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 10:36:46,898 - __main__ - INFO - 
2025-12-09 10:36:46,899 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 10:36:48,456 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_103646.pdf
2025-12-09 10:36:48,457 - __main__ - INFO - 
2025-12-09 10:36:48,458 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_103646.pdf
2025-12-09 10:36:48,459 - __main__ - INFO - [STATUS UPDATE] f9d98bf9-af38-4518-a90d-f8036071b7e8 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_103646.pdf
2025-12-09 10:36:48,459 - __main__ - INFO - [MQTT] Published to topic: controltower/server_pm_reportform_pdf_status/f9d98bf9-af38-4518-a90d-f8036071b7e8
2025-12-09 10:50:36,668 - __main__ - INFO - 
2025-12-09 10:50:36,669 - __main__ - INFO - Cleaning up resources...
2025-12-09 10:50:41,226 - __main__ - INFO - 
2025-12-09 10:50:41,227 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 10:50:41,230 - __main__ - INFO - 
2025-12-09 10:50:41,230 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 10:50:41,230 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 10:50:41,231 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 10:50:41,231 - __main__ - INFO - Authenticating with API...
2025-12-09 10:50:41,231 - __main__ - INFO - 
2025-12-09 10:50:41,232 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 10:50:41,280 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 10:50:41,281 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 10:50:48,870 - __main__ - INFO - 
2025-12-09 10:50:48,871 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 10:50:48,874 - __main__ - INFO - 
2025-12-09 10:50:48,874 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 10:50:48,874 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T02:50:48.8341646Z
2025-12-09 10:50:48,875 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 10:50:48,879 - __main__ - INFO - 
2025-12-09 10:50:48,879 - __main__ - INFO - 
2025-12-09 10:50:48,879 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 10:50:48,880 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 10:50:48,880 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 10:50:48,881 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 10:50:48,882 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 10:50:48,882 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 10:50:48,883 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 10:50:48,883 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 10:50:48,884 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 10:53:00,555 - __main__ - INFO - 
2025-12-09 10:53:00,556 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 7f1f9937-3634-49eb-80e3-8cc9bc59c7b9
2025-12-09 10:53:00,556 - __main__ - INFO - [DATA] Message data: {'report_id': '7f1f9937-3634-49eb-80e3-8cc9bc59c7b9', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T02:53:00.5429594Z', 'report_type': 'cm_final_report'}
2025-12-09 10:53:00,560 - __main__ - INFO - 
2025-12-09 10:53:00,561 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 7f1f9937-3634-49eb-80e3-8cc9bc59c7b9 (cm_reportform_signature_pdf)
2025-12-09 10:53:00,561 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 10:53:00,562 - __main__ - INFO - [STATUS UPDATE] 7f1f9937-3634-49eb-80e3-8cc9bc59c7b9 -> PROCESSING - PDF generation started
2025-12-09 10:53:00,563 - __main__ - INFO - [MQTT] Published to topic: controltower/cm_reportform_signature_pdf_status/7f1f9937-3634-49eb-80e3-8cc9bc59c7b9
2025-12-09 10:53:00,565 - __main__ - INFO - 
2025-12-09 10:53:00,566 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 10:53:00,567 - __main__ - INFO - 
2025-12-09 10:53:00,567 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 10:53:00,569 - __main__ - INFO - 
2025-12-09 10:53:00,569 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/7f1f9937-3634-49eb-80e3-8cc9bc59c7b9
2025-12-09 10:53:00,570 - __main__ - INFO - 
2025-12-09 10:53:00,570 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/7f1f9937-3634-49eb-80e3-8cc9bc59c7b9
2025-12-09 10:53:00,706 - __main__ - INFO - 
2025-12-09 10:53:00,707 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 10:53:00,707 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 10:53:00,708 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 10:53:01,202 - __main__ - INFO - 
2025-12-09 10:53:01,203 - __main__ - INFO - [API] Response Status: 200
2025-12-09 10:53:01,204 - __main__ - INFO - 
2025-12-09 10:53:01,205 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3800 chars)
2025-12-09 10:53:01,206 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 10:53:01,208 - __main__ - INFO - 
2025-12-09 10:53:01,209 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 10:53:01,209 - __main__ - INFO - 
2025-12-09 10:53:01,210 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 10:53:01,210 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 10:53:01,474 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\7f1f9937-3634-49eb-80e3-8cc9bc59c7b9\Signatures\20251209_105257_f82cadb5d2714765871d90674701f47b.png
2025-12-09 10:53:01,475 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\7f1f9937-3634-49eb-80e3-8cc9bc59c7b9\Signatures\20251209_105257_51179f716b8f4ee3a6c5310ea50b643f.png
2025-12-09 10:53:01,478 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 10:53:01,479 - __main__ - INFO - 
2025-12-09 10:53:01,479 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 10:53:01,480 - __main__ - INFO - 
2025-12-09 10:53:01,482 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 10:53:01,580 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 10:53:03,161 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010002_20251209_105301.pdf
2025-12-09 10:53:03,162 - __main__ - INFO - 
2025-12-09 10:53:03,163 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010002_20251209_105301.pdf
2025-12-09 10:53:03,164 - __main__ - INFO - [STATUS UPDATE] 7f1f9937-3634-49eb-80e3-8cc9bc59c7b9 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010002_20251209_105301.pdf
2025-12-09 10:53:03,164 - __main__ - INFO - [MQTT] Published to topic: controltower/cm_reportform_signature_pdf_status/7f1f9937-3634-49eb-80e3-8cc9bc59c7b9
2025-12-09 10:58:55,305 - __main__ - INFO - 
2025-12-09 10:58:55,306 - __main__ - INFO - Cleaning up resources...
2025-12-09 10:58:58,983 - __main__ - INFO - 
2025-12-09 10:58:58,984 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 10:58:58,985 - __main__ - INFO - 
2025-12-09 10:58:58,986 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 10:58:58,986 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 10:58:58,986 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 10:58:58,986 - __main__ - INFO - Authenticating with API...
2025-12-09 10:58:58,986 - __main__ - INFO - 
2025-12-09 10:58:58,986 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 10:58:59,024 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 10:58:59,025 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 10:58:59,486 - __main__ - INFO - 
2025-12-09 10:58:59,486 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 10:58:59,486 - __main__ - INFO - 
2025-12-09 10:58:59,487 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 10:58:59,487 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T02:58:59.48508Z
2025-12-09 10:58:59,488 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 10:58:59,506 - __main__ - INFO - 
2025-12-09 10:58:59,506 - __main__ - INFO - 
2025-12-09 10:58:59,507 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 10:58:59,507 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 10:58:59,507 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 10:58:59,508 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 10:58:59,509 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 10:58:59,510 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 10:58:59,510 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 10:58:59,510 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 10:58:59,511 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:00:19,969 - __main__ - INFO - 
2025-12-09 11:00:19,970 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 7d8e7f30-56db-44ff-94fb-6acc76dcfdf0
2025-12-09 11:00:19,971 - __main__ - INFO - [DATA] Message data: {'report_id': '7d8e7f30-56db-44ff-94fb-6acc76dcfdf0', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:00:19.9677787Z', 'report_type': 'cm_final_report'}
2025-12-09 11:00:19,975 - __main__ - INFO - 
2025-12-09 11:00:19,976 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 7d8e7f30-56db-44ff-94fb-6acc76dcfdf0 (cm_reportform_signature_pdf)
2025-12-09 11:00:19,976 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:00:19,977 - __main__ - INFO - [STATUS UPDATE] 7d8e7f30-56db-44ff-94fb-6acc76dcfdf0 -> PROCESSING - PDF generation started
2025-12-09 11:00:19,978 - __main__ - INFO - [MQTT] Published to topic: controltower/cm_reportform_signature_pdf_status/7d8e7f30-56db-44ff-94fb-6acc76dcfdf0
2025-12-09 11:00:19,979 - __main__ - INFO - 
2025-12-09 11:00:19,979 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:00:19,980 - __main__ - INFO - 
2025-12-09 11:00:19,980 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:00:19,981 - __main__ - INFO - 
2025-12-09 11:00:19,982 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/7d8e7f30-56db-44ff-94fb-6acc76dcfdf0
2025-12-09 11:00:19,982 - __main__ - INFO - 
2025-12-09 11:00:19,983 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/7d8e7f30-56db-44ff-94fb-6acc76dcfdf0
2025-12-09 11:00:20,077 - __main__ - INFO - 
2025-12-09 11:00:20,078 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:00:20,078 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:00:20,079 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:01:13,256 - __main__ - INFO - 
2025-12-09 11:01:13,257 - __main__ - ERROR - [API REQUEST ERROR] Cannot connect to host localhost:7145 ssl:default [The specified network name is no longer available]
2025-12-09 11:01:13,257 - __main__ - ERROR - [STEP 5 FAILED] No data received from API
2025-12-09 11:01:13,258 - __main__ - INFO - [STATUS UPDATE] 7d8e7f30-56db-44ff-94fb-6acc76dcfdf0 -> FAILED - Failed to retrieve data from API
2025-12-09 11:01:13,259 - __main__ - INFO - [MQTT] Published to topic: controltower/cm_reportform_signature_pdf_status/7d8e7f30-56db-44ff-94fb-6acc76dcfdf0
2025-12-09 11:02:52,333 - __main__ - INFO - 
2025-12-09 11:02:52,334 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:02:57,732 - __main__ - INFO - 
2025-12-09 11:02:57,733 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:02:57,735 - __main__ - INFO - 
2025-12-09 11:02:57,735 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:02:57,736 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:02:57,737 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:02:57,737 - __main__ - INFO - Authenticating with API...
2025-12-09 11:02:57,738 - __main__ - INFO - 
2025-12-09 11:02:57,738 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:02:57,830 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:02:57,830 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:02:58,746 - __main__ - INFO - 
2025-12-09 11:02:58,746 - __main__ - ERROR - [AUTH] Authentication error: [WinError 64] The specified network name is no longer available
2025-12-09 11:02:58,747 - __main__ - ERROR - Failed to authenticate with API. Service cannot start.
2025-12-09 11:02:58,748 - __main__ - INFO - 
2025-12-09 11:02:58,748 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:02:58,749 - __main__ - INFO - 
2025-12-09 11:02:58,749 - __main__ - INFO - Cleanup completed
2025-12-09 11:09:16,525 - __main__ - INFO - 
2025-12-09 11:09:16,526 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:09:16,527 - __main__ - INFO - 
2025-12-09 11:09:16,527 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:09:16,527 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:09:16,527 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:09:16,528 - __main__ - INFO - Authenticating with API...
2025-12-09 11:09:16,528 - __main__ - INFO - 
2025-12-09 11:09:16,528 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:09:16,553 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:09:16,554 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:09:17,683 - __main__ - INFO - 
2025-12-09 11:09:17,683 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 11:09:17,684 - __main__ - INFO - 
2025-12-09 11:09:17,684 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 11:09:17,684 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T03:09:17.6731017Z
2025-12-09 11:09:17,685 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 11:09:17,702 - __main__ - INFO - 
2025-12-09 11:09:17,703 - __main__ - INFO - 
2025-12-09 11:09:17,703 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 11:09:17,703 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 11:09:17,704 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 11:09:17,705 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 11:09:17,706 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 11:09:17,707 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 11:09:17,707 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 11:09:17,708 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 11:09:17,708 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:10:34,120 - __main__ - INFO - 
2025-12-09 11:10:34,123 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: add86271-4f9a-41e8-913f-749abdc79a27
2025-12-09 11:10:34,124 - __main__ - INFO - [DATA] Message data: {'report_id': 'add86271-4f9a-41e8-913f-749abdc79a27', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:10:34.1194289Z', 'report_type': 'cm_final_report'}
2025-12-09 11:10:34,145 - __main__ - INFO - 
2025-12-09 11:10:34,145 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: add86271-4f9a-41e8-913f-749abdc79a27 (cm_reportform_signature_pdf)
2025-12-09 11:10:34,146 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:10:34,147 - __main__ - INFO - [STATUS UPDATE] add86271-4f9a-41e8-913f-749abdc79a27 -> PROCESSING - PDF generation started
2025-12-09 11:10:34,147 - __main__ - INFO - [MQTT] Published to topic: controltower/cm_reportform_signature_pdf_status/add86271-4f9a-41e8-913f-749abdc79a27
2025-12-09 11:10:34,148 - __main__ - INFO - 
2025-12-09 11:10:34,148 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:10:34,148 - __main__ - INFO - 
2025-12-09 11:10:34,149 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:10:34,150 - __main__ - INFO - 
2025-12-09 11:10:34,152 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/add86271-4f9a-41e8-913f-749abdc79a27
2025-12-09 11:10:34,153 - __main__ - INFO - 
2025-12-09 11:10:34,154 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/add86271-4f9a-41e8-913f-749abdc79a27
2025-12-09 11:10:34,278 - __main__ - INFO - 
2025-12-09 11:10:34,278 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:10:34,279 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:10:34,279 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:10:34,812 - __main__ - INFO - 
2025-12-09 11:10:34,813 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:10:34,814 - __main__ - INFO - 
2025-12-09 11:10:34,814 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3796 chars)
2025-12-09 11:10:34,815 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:10:34,817 - __main__ - INFO - 
2025-12-09 11:10:34,818 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:10:34,818 - __main__ - INFO - 
2025-12-09 11:10:34,819 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:10:34,819 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:10:35,010 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\add86271-4f9a-41e8-913f-749abdc79a27\Signatures\20251209_111034_d64dbb2d9628455592b610ec09a17fd0.png
2025-12-09 11:10:35,011 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\add86271-4f9a-41e8-913f-749abdc79a27\Signatures\20251209_111033_a002f3484f5a4c0eab1c3d08ed0f2d6b.png
2025-12-09 11:10:35,012 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:10:35,012 - __main__ - INFO - 
2025-12-09 11:10:35,012 - __main__ - INFO - [STEP 7] Using job number: 10010003
2025-12-09 11:10:35,013 - __main__ - INFO - 
2025-12-09 11:10:35,013 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:10:35,109 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:10:36,514 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010003_20251209_111035.pdf
2025-12-09 11:10:36,515 - __main__ - INFO - 
2025-12-09 11:10:36,515 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010003_20251209_111035.pdf
2025-12-09 11:10:36,516 - __main__ - INFO - [STATUS UPDATE] add86271-4f9a-41e8-913f-749abdc79a27 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010003_20251209_111035.pdf
2025-12-09 11:10:36,517 - __main__ - INFO - [MQTT] Published to topic: controltower/cm_reportform_signature_pdf_status/add86271-4f9a-41e8-913f-749abdc79a27
2025-12-09 11:20:05,040 - __main__ - INFO - 
2025-12-09 11:20:05,042 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:22:38,464 - __main__ - INFO - 
2025-12-09 11:22:38,465 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:22:38,467 - __main__ - INFO - 
2025-12-09 11:22:38,468 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:22:38,469 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:22:38,469 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:22:38,470 - __main__ - INFO - Authenticating with API...
2025-12-09 11:22:38,470 - __main__ - INFO - 
2025-12-09 11:22:38,470 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:22:38,496 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:22:38,496 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:22:45,983 - __main__ - INFO - 
2025-12-09 11:22:45,983 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 11:22:45,986 - __main__ - INFO - 
2025-12-09 11:22:45,987 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 11:22:45,987 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T03:22:45.9454985Z
2025-12-09 11:22:45,988 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 11:22:46,004 - __main__ - INFO - 
2025-12-09 11:22:46,004 - __main__ - INFO - 
2025-12-09 11:22:46,005 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 11:22:46,005 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 11:22:46,006 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 11:22:46,007 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 11:22:46,007 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 11:22:46,008 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 11:22:46,008 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 11:22:46,009 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 11:22:46,010 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:25:07,498 - __main__ - INFO - 
2025-12-09 11:25:07,498 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 8c62188c-4a6f-4681-abd3-a0e53b3a416f
2025-12-09 11:25:07,499 - __main__ - INFO - [DATA] Message data: {'report_id': '8c62188c-4a6f-4681-abd3-a0e53b3a416f', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:25:07.4766331Z', 'report_type': 'cm_final_report'}
2025-12-09 11:25:07,503 - __main__ - INFO - 
2025-12-09 11:25:07,504 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 8c62188c-4a6f-4681-abd3-a0e53b3a416f (cm_reportform_signature_pdf)
2025-12-09 11:25:07,505 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:25:07,505 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/8c62188c-4a6f-4681-abd3-a0e53b3a416f
2025-12-09 11:25:07,506 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "8c62188c-4a6f-4681-abd3-a0e53b3a416f",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:25:07.505848"
}
2025-12-09 11:25:07,509 - __main__ - INFO - [STATUS UPDATE] 8c62188c-4a6f-4681-abd3-a0e53b3a416f -> PROCESSING - PDF generation started
2025-12-09 11:25:07,510 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 11:25:07,615 - __main__ - INFO - 
2025-12-09 11:25:07,618 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:25:07,623 - __main__ - INFO - 
2025-12-09 11:25:07,633 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:25:07,642 - __main__ - INFO - 
2025-12-09 11:25:07,647 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/8c62188c-4a6f-4681-abd3-a0e53b3a416f
2025-12-09 11:25:07,651 - __main__ - INFO - 
2025-12-09 11:25:07,653 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/8c62188c-4a6f-4681-abd3-a0e53b3a416f
2025-12-09 11:25:07,769 - __main__ - INFO - 
2025-12-09 11:25:07,771 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:25:07,772 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:25:07,773 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:25:08,345 - __main__ - INFO - 
2025-12-09 11:25:08,346 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:25:08,346 - __main__ - INFO - 
2025-12-09 11:25:08,347 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3789 chars)
2025-12-09 11:25:08,348 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:25:08,350 - __main__ - INFO - 
2025-12-09 11:25:08,351 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:25:08,351 - __main__ - INFO - 
2025-12-09 11:25:08,352 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:25:08,352 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:25:08,553 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\8c62188c-4a6f-4681-abd3-a0e53b3a416f\Signatures\20251209_112507_8131c9d0334c4c4dbb98df916ecedbf4.png
2025-12-09 11:25:08,553 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\8c62188c-4a6f-4681-abd3-a0e53b3a416f\Signatures\20251209_112507_f615c19596ae44e9af87721162031cf0.png
2025-12-09 11:25:08,556 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:25:08,557 - __main__ - INFO - 
2025-12-09 11:25:08,558 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:25:08,558 - __main__ - INFO - 
2025-12-09 11:25:08,559 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:25:08,649 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:25:10,012 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_112508.pdf
2025-12-09 11:25:10,013 - __main__ - INFO - 
2025-12-09 11:25:10,014 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_112508.pdf
2025-12-09 11:25:10,015 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/8c62188c-4a6f-4681-abd3-a0e53b3a416f
2025-12-09 11:25:10,015 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "8c62188c-4a6f-4681-abd3-a0e53b3a416f",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_112508.pdf",
  "timestamp": "2025-12-09T11:25:10.014972",
  "file_name": "CM_FinalReport_Report_10010001_20251209_112508.pdf"
}
2025-12-09 11:25:10,016 - __main__ - INFO - [STATUS UPDATE] 8c62188c-4a6f-4681-abd3-a0e53b3a416f -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_112508.pdf
2025-12-09 11:25:10,017 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 11:26:37,345 - __main__ - INFO - 
2025-12-09 11:26:37,345 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:26:40,809 - __main__ - INFO - 
2025-12-09 11:26:40,810 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:26:40,811 - __main__ - INFO - 
2025-12-09 11:26:40,811 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:26:40,812 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:26:40,812 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:26:40,812 - __main__ - INFO - Authenticating with API...
2025-12-09 11:26:40,812 - __main__ - INFO - 
2025-12-09 11:26:40,812 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:26:40,838 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:26:40,838 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:26:41,288 - __main__ - INFO - 
2025-12-09 11:26:41,288 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 11:26:41,289 - __main__ - INFO - 
2025-12-09 11:26:41,289 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 11:26:41,289 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T03:26:41.2872026Z
2025-12-09 11:26:41,290 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 11:26:41,302 - __main__ - INFO - 
2025-12-09 11:26:41,303 - __main__ - INFO - 
2025-12-09 11:26:41,303 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 11:26:41,303 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 11:26:41,304 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 11:26:41,305 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 11:26:41,305 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 11:26:41,306 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 11:26:41,307 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 11:26:41,307 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 11:26:41,308 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:29:17,712 - __main__ - INFO - 
2025-12-09 11:29:17,712 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:29:17,713 - __main__ - INFO - [DATA] Message data: {'report_id': '80cee009-2a6d-4dea-ade9-74a50e021b76', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:29:17.7055549Z', 'report_type': 'cm_final_report'}
2025-12-09 11:29:17,716 - __main__ - INFO - 
2025-12-09 11:29:17,717 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 80cee009-2a6d-4dea-ade9-74a50e021b76 (cm_reportform_signature_pdf)
2025-12-09 11:29:17,717 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:29:17,718 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:29:17,718 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "80cee009-2a6d-4dea-ade9-74a50e021b76",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:29:17.718337"
}
2025-12-09 11:29:17,720 - __main__ - INFO - [STATUS UPDATE] 80cee009-2a6d-4dea-ade9-74a50e021b76 -> PROCESSING - PDF generation started
2025-12-09 11:29:17,721 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 11:29:17,722 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:29:17,723 - __main__ - INFO - 
2025-12-09 11:29:17,723 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:29:17,724 - __main__ - INFO - 
2025-12-09 11:29:17,724 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:29:17,725 - __main__ - INFO - 
2025-12-09 11:29:17,726 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:29:17,726 - __main__ - INFO - 
2025-12-09 11:29:17,726 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:29:17,832 - __main__ - INFO - 
2025-12-09 11:29:17,832 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:29:17,833 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:29:17,833 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:29:18,003 - __main__ - INFO - 
2025-12-09 11:29:18,004 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:29:18,005 - __main__ - INFO - 
2025-12-09 11:29:18,006 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3807 chars)
2025-12-09 11:29:18,006 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:29:18,008 - __main__ - INFO - 
2025-12-09 11:29:18,008 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:29:18,009 - __main__ - INFO - 
2025-12-09 11:29:18,009 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:29:18,010 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:29:18,191 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\80cee009-2a6d-4dea-ade9-74a50e021b76\Signatures\20251209_112917_8504424694e0473bb877edf752319663.png
2025-12-09 11:29:18,191 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\80cee009-2a6d-4dea-ade9-74a50e021b76\Signatures\20251209_112917_055a8f93d5b84c5cae1d8a159e43a23f.png
2025-12-09 11:29:18,192 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:29:18,193 - __main__ - INFO - 
2025-12-09 11:29:18,193 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:29:18,193 - __main__ - INFO - 
2025-12-09 11:29:18,194 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:29:18,282 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:29:19,655 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_112918.pdf
2025-12-09 11:29:19,657 - __main__ - INFO - 
2025-12-09 11:29:19,657 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_112918.pdf
2025-12-09 11:29:19,658 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:29:19,658 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "80cee009-2a6d-4dea-ade9-74a50e021b76",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_112918.pdf",
  "timestamp": "2025-12-09T11:29:19.658171",
  "file_name": "CM_FinalReport_Report_10010001_20251209_112918.pdf"
}
2025-12-09 11:29:19,659 - __main__ - INFO - [STATUS UPDATE] 80cee009-2a6d-4dea-ade9-74a50e021b76 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_112918.pdf
2025-12-09 11:29:19,660 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 11:29:19,660 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/80cee009-2a6d-4dea-ade9-74a50e021b76
2025-12-09 11:36:23,387 - __main__ - INFO - 
2025-12-09 11:36:23,388 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:36:23,389 - __main__ - INFO - [DATA] Message data: {'report_id': 'a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:36:23.3818558Z', 'report_type': 'cm_final_report'}
2025-12-09 11:36:23,394 - __main__ - INFO - 
2025-12-09 11:36:23,395 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6 (cm_reportform_signature_pdf)
2025-12-09 11:36:23,395 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:36:23,396 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:36:23,396 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:36:23.396223"
}
2025-12-09 11:36:23,397 - __main__ - INFO - [STATUS UPDATE] a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6 -> PROCESSING - PDF generation started
2025-12-09 11:36:23,398 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=9
2025-12-09 11:36:23,398 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:36:23,399 - __main__ - INFO - 
2025-12-09 11:36:23,400 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:36:23,400 - __main__ - INFO - 
2025-12-09 11:36:23,400 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:36:23,505 - __main__ - INFO - 
2025-12-09 11:36:23,506 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:36:23,506 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:36:23,507 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:36:23,675 - __main__ - INFO - 
2025-12-09 11:36:23,676 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:36:23,676 - __main__ - INFO - 
2025-12-09 11:36:23,677 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3801 chars)
2025-12-09 11:36:23,678 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:36:23,680 - __main__ - INFO - 
2025-12-09 11:36:23,680 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:36:23,681 - __main__ - INFO - 
2025-12-09 11:36:23,681 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:36:23,682 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:36:23,735 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6\Signatures\20251209_113623_0dc6dae77d974301972ca94e5ff06acf.png
2025-12-09 11:36:23,736 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6\Signatures\20251209_113623_ffa6f2615d964c98b0c73881f2e0be23.png
2025-12-09 11:36:23,737 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:36:23,737 - __main__ - INFO - 
2025-12-09 11:36:23,737 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:36:23,737 - __main__ - INFO - 
2025-12-09 11:36:23,738 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:36:23,767 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:36:25,072 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_113623.pdf
2025-12-09 11:36:25,073 - __main__ - INFO - 
2025-12-09 11:36:25,073 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_113623.pdf
2025-12-09 11:36:25,074 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:36:25,074 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_113623.pdf",
  "timestamp": "2025-12-09T11:36:25.074129",
  "file_name": "CM_FinalReport_Report_10010001_20251209_113623.pdf"
}
2025-12-09 11:36:25,075 - __main__ - INFO - [STATUS UPDATE] a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_113623.pdf
2025-12-09 11:36:25,076 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=10
2025-12-09 11:36:25,076 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/a730a1a6-5c3f-4d40-ae59-ebb5b4ec31d6
2025-12-09 11:42:35,614 - __main__ - INFO - 
2025-12-09 11:42:35,615 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:42:35,615 - __main__ - INFO - [DATA] Message data: {'report_id': '61e79349-076d-4142-a979-7fa069036928', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:42:35.5949781Z', 'report_type': 'cm_final_report'}
2025-12-09 11:42:35,620 - __main__ - INFO - 
2025-12-09 11:42:35,620 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 61e79349-076d-4142-a979-7fa069036928 (cm_reportform_signature_pdf)
2025-12-09 11:42:35,621 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:42:35,621 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:42:35,622 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "61e79349-076d-4142-a979-7fa069036928",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:42:35.621768"
}
2025-12-09 11:42:35,623 - __main__ - INFO - [STATUS UPDATE] 61e79349-076d-4142-a979-7fa069036928 -> PROCESSING - PDF generation started
2025-12-09 11:42:35,624 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=11
2025-12-09 11:42:35,624 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:42:35,625 - __main__ - INFO - 
2025-12-09 11:42:35,625 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:42:35,626 - __main__ - INFO - 
2025-12-09 11:42:35,626 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:42:35,752 - __main__ - INFO - 
2025-12-09 11:42:35,752 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:42:35,753 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:42:35,753 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:42:36,362 - __main__ - INFO - 
2025-12-09 11:42:36,363 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:42:36,364 - __main__ - INFO - 
2025-12-09 11:42:36,364 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3795 chars)
2025-12-09 11:42:36,365 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:42:36,367 - __main__ - INFO - 
2025-12-09 11:42:36,368 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:42:36,369 - __main__ - INFO - 
2025-12-09 11:42:36,369 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:42:36,370 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:42:36,411 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\61e79349-076d-4142-a979-7fa069036928\Signatures\20251209_114235_8d3e5ccd208044a8a6ed95cf1630648c.png
2025-12-09 11:42:36,412 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\61e79349-076d-4142-a979-7fa069036928\Signatures\20251209_114235_ec29d110a7ab43279e1b3714147f1260.png
2025-12-09 11:42:36,414 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:42:36,414 - __main__ - INFO - 
2025-12-09 11:42:36,415 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:42:36,415 - __main__ - INFO - 
2025-12-09 11:42:36,416 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:42:36,467 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:42:37,851 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_114236.pdf
2025-12-09 11:42:37,851 - __main__ - INFO - 
2025-12-09 11:42:37,852 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_114236.pdf
2025-12-09 11:42:37,852 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:42:37,853 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "61e79349-076d-4142-a979-7fa069036928",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_114236.pdf",
  "timestamp": "2025-12-09T11:42:37.852908",
  "file_name": "CM_FinalReport_Report_10010001_20251209_114236.pdf"
}
2025-12-09 11:42:37,854 - __main__ - INFO - [STATUS UPDATE] 61e79349-076d-4142-a979-7fa069036928 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_114236.pdf
2025-12-09 11:42:37,855 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=12
2025-12-09 11:42:37,856 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/61e79349-076d-4142-a979-7fa069036928
2025-12-09 11:45:13,822 - __main__ - INFO - 
2025-12-09 11:45:13,822 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:45:17,674 - __main__ - INFO - 
2025-12-09 11:45:17,675 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:45:17,676 - __main__ - INFO - 
2025-12-09 11:45:17,677 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:45:17,677 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:45:17,677 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:45:17,678 - __main__ - INFO - Authenticating with API...
2025-12-09 11:45:17,678 - __main__ - INFO - 
2025-12-09 11:45:17,678 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:45:17,707 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:45:17,707 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:45:18,841 - __main__ - INFO - 
2025-12-09 11:45:18,842 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 11:45:18,843 - __main__ - INFO - 
2025-12-09 11:45:18,844 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 11:45:18,844 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T03:45:18.8303608Z
2025-12-09 11:45:18,846 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 11:45:18,871 - __main__ - INFO - 
2025-12-09 11:45:18,871 - __main__ - INFO - 
2025-12-09 11:45:18,872 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 11:45:18,872 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 11:45:18,872 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 11:45:18,873 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 11:45:18,874 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 11:45:18,875 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 11:45:18,875 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 11:45:18,876 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 11:45:18,877 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:47:22,438 - __main__ - INFO - 
2025-12-09 11:47:22,439 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:47:22,440 - __main__ - INFO - [DATA] Message data: {'report_id': '8c4da208-f5fb-4943-830f-ca4fce377194', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:47:22.4322998Z', 'report_type': 'cm_final_report'}
2025-12-09 11:47:22,444 - __main__ - INFO - 
2025-12-09 11:47:22,445 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 8c4da208-f5fb-4943-830f-ca4fce377194 (cm_reportform_signature_pdf)
2025-12-09 11:47:22,446 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:47:22,447 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:47:22,448 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "8c4da208-f5fb-4943-830f-ca4fce377194",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:47:22.447447"
}
2025-12-09 11:47:22,450 - __main__ - INFO - [STATUS UPDATE] 8c4da208-f5fb-4943-830f-ca4fce377194 -> PROCESSING - PDF generation started
2025-12-09 11:47:22,452 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 11:47:22,454 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:47:22,456 - __main__ - INFO - 
2025-12-09 11:47:22,457 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:47:22,459 - __main__ - INFO - 
2025-12-09 11:47:22,460 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:47:22,462 - __main__ - INFO - 
2025-12-09 11:47:22,463 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:47:22,464 - __main__ - INFO - 
2025-12-09 11:47:22,466 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:47:22,585 - __main__ - INFO - 
2025-12-09 11:47:22,585 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:47:22,586 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:47:22,586 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:47:22,752 - __main__ - INFO - 
2025-12-09 11:47:22,753 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:47:22,754 - __main__ - INFO - 
2025-12-09 11:47:22,754 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3809 chars)
2025-12-09 11:47:22,755 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:47:22,756 - __main__ - INFO - 
2025-12-09 11:47:22,757 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:47:22,757 - __main__ - INFO - 
2025-12-09 11:47:22,758 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:47:22,758 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:47:22,926 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\8c4da208-f5fb-4943-830f-ca4fce377194\Signatures\20251209_114722_f2c711cd9d0b404f8349ea684c3db627.png
2025-12-09 11:47:22,927 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\8c4da208-f5fb-4943-830f-ca4fce377194\Signatures\20251209_114722_62ae139c78514179a3f28975f9daaff0.png
2025-12-09 11:47:22,928 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:47:22,928 - __main__ - INFO - 
2025-12-09 11:47:22,928 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:47:22,929 - __main__ - INFO - 
2025-12-09 11:47:22,929 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:47:23,020 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:47:24,365 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_114722.pdf
2025-12-09 11:47:24,366 - __main__ - INFO - 
2025-12-09 11:47:24,367 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_114722.pdf
2025-12-09 11:47:24,367 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:47:24,368 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "8c4da208-f5fb-4943-830f-ca4fce377194",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_114722.pdf",
  "timestamp": "2025-12-09T11:47:24.367710",
  "file_name": "CM_FinalReport_Report_10010001_20251209_114722.pdf"
}
2025-12-09 11:47:24,369 - __main__ - INFO - [STATUS UPDATE] 8c4da208-f5fb-4943-830f-ca4fce377194 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_114722.pdf
2025-12-09 11:47:24,369 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 11:47:24,370 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/8c4da208-f5fb-4943-830f-ca4fce377194
2025-12-09 11:49:31,582 - __main__ - INFO - 
2025-12-09 11:49:31,582 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:49:54,498 - __main__ - INFO - 
2025-12-09 11:49:54,499 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:49:54,500 - __main__ - INFO - 
2025-12-09 11:49:54,500 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:49:54,500 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:49:54,501 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:49:54,501 - __main__ - INFO - Authenticating with API...
2025-12-09 11:49:54,501 - __main__ - INFO - 
2025-12-09 11:49:54,501 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:49:54,540 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:49:54,540 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:49:54,894 - __main__ - INFO - 
2025-12-09 11:49:54,894 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 11:49:54,895 - __main__ - INFO - 
2025-12-09 11:49:54,895 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 11:49:54,896 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T03:49:54.8916375Z
2025-12-09 11:49:54,897 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 11:49:54,907 - __main__ - INFO - 
2025-12-09 11:49:54,907 - __main__ - INFO - 
2025-12-09 11:49:54,907 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 11:49:54,908 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 11:49:54,909 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 11:49:54,909 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 11:49:54,909 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 11:49:54,910 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 11:49:54,911 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 11:49:54,912 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 11:49:54,913 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:51:35,324 - __main__ - INFO - 
2025-12-09 11:51:35,325 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:51:35,328 - __main__ - INFO - [DATA] Message data: {'report_id': '8e975f8d-4a3e-4ca5-bd94-791d181f4bfd', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:51:35.3142381Z', 'report_type': 'cm_final_report'}
2025-12-09 11:51:35,343 - __main__ - INFO - 
2025-12-09 11:51:35,347 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 8e975f8d-4a3e-4ca5-bd94-791d181f4bfd (cm_reportform_signature_pdf)
2025-12-09 11:51:35,349 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:51:35,352 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:51:35,354 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "8e975f8d-4a3e-4ca5-bd94-791d181f4bfd",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:51:35.352452"
}
2025-12-09 11:51:35,358 - __main__ - INFO - [STATUS UPDATE] 8e975f8d-4a3e-4ca5-bd94-791d181f4bfd -> PROCESSING - PDF generation started
2025-12-09 11:51:35,361 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 11:51:35,363 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:51:35,365 - __main__ - INFO - 
2025-12-09 11:51:35,366 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:51:35,366 - __main__ - INFO - 
2025-12-09 11:51:35,370 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:51:35,374 - __main__ - INFO - 
2025-12-09 11:51:35,375 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:51:35,379 - __main__ - INFO - 
2025-12-09 11:51:35,382 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:51:35,518 - __main__ - INFO - 
2025-12-09 11:51:35,518 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:51:35,518 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:51:35,519 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:51:35,693 - __main__ - INFO - 
2025-12-09 11:51:35,694 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:51:35,696 - __main__ - INFO - 
2025-12-09 11:51:35,697 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3819 chars)
2025-12-09 11:51:35,697 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:51:35,699 - __main__ - INFO - 
2025-12-09 11:51:35,699 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:51:35,700 - __main__ - INFO - 
2025-12-09 11:51:35,700 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:51:35,701 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:51:35,919 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\8e975f8d-4a3e-4ca5-bd94-791d181f4bfd\Signatures\20251209_115135_17b28444dc16486eb72a7c9355270601.png
2025-12-09 11:51:35,919 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\8e975f8d-4a3e-4ca5-bd94-791d181f4bfd\Signatures\20251209_115135_9a1984702bd0461f89daf8316d819b82.png
2025-12-09 11:51:35,921 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:51:35,921 - __main__ - INFO - 
2025-12-09 11:51:35,922 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:51:35,922 - __main__ - INFO - 
2025-12-09 11:51:35,923 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:51:36,015 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:51:37,378 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_115135.pdf
2025-12-09 11:51:37,379 - __main__ - INFO - 
2025-12-09 11:51:37,379 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_115135.pdf
2025-12-09 11:51:37,380 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:51:37,380 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "8e975f8d-4a3e-4ca5-bd94-791d181f4bfd",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_115135.pdf",
  "timestamp": "2025-12-09T11:51:37.380163",
  "file_name": "CM_FinalReport_Report_10010001_20251209_115135.pdf"
}
2025-12-09 11:51:37,381 - __main__ - INFO - [STATUS UPDATE] 8e975f8d-4a3e-4ca5-bd94-791d181f4bfd -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_115135.pdf
2025-12-09 11:51:37,381 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 11:51:37,382 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/8e975f8d-4a3e-4ca5-bd94-791d181f4bfd
2025-12-09 11:54:33,754 - __main__ - INFO - 
2025-12-09 11:54:33,754 - __main__ - INFO - Cleaning up resources...
2025-12-09 11:54:42,531 - __main__ - INFO - 
2025-12-09 11:54:42,532 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 11:54:42,533 - __main__ - INFO - 
2025-12-09 11:54:42,533 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 11:54:42,534 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 11:54:42,534 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 11:54:42,534 - __main__ - INFO - Authenticating with API...
2025-12-09 11:54:42,535 - __main__ - INFO - 
2025-12-09 11:54:42,535 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 11:54:42,614 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 11:54:42,615 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 11:54:43,050 - __main__ - INFO - 
2025-12-09 11:54:43,051 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 11:54:43,051 - __main__ - INFO - 
2025-12-09 11:54:43,052 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 11:54:43,052 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T03:54:43.0497507Z
2025-12-09 11:54:43,055 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 11:54:43,077 - __main__ - INFO - 
2025-12-09 11:54:43,077 - __main__ - INFO - 
2025-12-09 11:54:43,078 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 11:54:43,078 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 11:54:43,079 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 11:54:43,080 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 11:54:43,081 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 11:54:43,081 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 11:54:43,082 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 11:54:43,082 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 11:54:43,083 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 11:57:01,202 - __main__ - INFO - 
2025-12-09 11:57:01,202 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 11:57:01,203 - __main__ - INFO - [DATA] Message data: {'report_id': 'a32063c1-5539-4b66-a12e-d999edca7346', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T03:57:01.1948442Z', 'report_type': 'cm_final_report'}
2025-12-09 11:57:01,208 - __main__ - INFO - 
2025-12-09 11:57:01,209 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: a32063c1-5539-4b66-a12e-d999edca7346 (cm_reportform_signature_pdf)
2025-12-09 11:57:01,211 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 11:57:01,213 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 11:57:01,214 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a32063c1-5539-4b66-a12e-d999edca7346",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T11:57:01.212853"
}
2025-12-09 11:57:01,215 - __main__ - INFO - [STATUS UPDATE] a32063c1-5539-4b66-a12e-d999edca7346 -> PROCESSING - PDF generation started
2025-12-09 11:57:01,216 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 11:57:01,216 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 11:57:01,217 - __main__ - INFO - 
2025-12-09 11:57:01,217 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 11:57:01,218 - __main__ - INFO - 
2025-12-09 11:57:01,218 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 11:57:01,221 - __main__ - INFO - 
2025-12-09 11:57:01,221 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 11:57:01,222 - __main__ - INFO - 
2025-12-09 11:57:01,223 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 11:57:01,355 - __main__ - INFO - 
2025-12-09 11:57:01,356 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 11:57:01,357 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 11:57:01,358 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 11:57:01,610 - __main__ - INFO - 
2025-12-09 11:57:01,611 - __main__ - INFO - [API] Response Status: 200
2025-12-09 11:57:01,614 - __main__ - INFO - 
2025-12-09 11:57:01,615 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3811 chars)
2025-12-09 11:57:01,615 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 11:57:01,618 - __main__ - INFO - 
2025-12-09 11:57:01,619 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 11:57:01,620 - __main__ - INFO - 
2025-12-09 11:57:01,621 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 11:57:01,622 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 11:57:01,882 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a32063c1-5539-4b66-a12e-d999edca7346\Signatures\20251209_115701_a5c8ba41b9814e55b7b1869cc88fdabd.png
2025-12-09 11:57:01,883 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a32063c1-5539-4b66-a12e-d999edca7346\Signatures\20251209_115700_33228ba5781a43d38f4787e994448922.png
2025-12-09 11:57:01,884 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 11:57:01,884 - __main__ - INFO - 
2025-12-09 11:57:01,884 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 11:57:01,885 - __main__ - INFO - 
2025-12-09 11:57:01,885 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 11:57:01,970 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 11:57:03,535 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_115701.pdf
2025-12-09 11:57:03,538 - __main__ - INFO - 
2025-12-09 11:57:03,540 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_115701.pdf
2025-12-09 11:57:03,544 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 11:57:03,549 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a32063c1-5539-4b66-a12e-d999edca7346",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_115701.pdf",
  "timestamp": "2025-12-09T11:57:03.544499",
  "file_name": "CM_FinalReport_Report_10010001_20251209_115701.pdf"
}
2025-12-09 11:57:03,555 - __main__ - INFO - [STATUS UPDATE] a32063c1-5539-4b66-a12e-d999edca7346 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_115701.pdf
2025-12-09 11:57:03,560 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 11:57:03,563 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/a32063c1-5539-4b66-a12e-d999edca7346
2025-12-09 12:01:45,176 - __main__ - INFO - 
2025-12-09 12:01:45,177 - __main__ - INFO - Cleaning up resources...
2025-12-09 12:01:49,534 - __main__ - INFO - 
2025-12-09 12:01:49,536 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 12:01:49,537 - __main__ - INFO - 
2025-12-09 12:01:49,537 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 12:01:49,538 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 12:01:49,538 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 12:01:49,538 - __main__ - INFO - Authenticating with API...
2025-12-09 12:01:49,538 - __main__ - INFO - 
2025-12-09 12:01:49,539 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 12:01:49,579 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 12:01:49,579 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 12:01:50,006 - __main__ - INFO - 
2025-12-09 12:01:50,007 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 12:01:50,008 - __main__ - INFO - 
2025-12-09 12:01:50,009 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 12:01:50,010 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T04:01:50.0052788Z
2025-12-09 12:01:50,012 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 12:01:50,018 - __main__ - INFO - 
2025-12-09 12:01:50,019 - __main__ - INFO - 
2025-12-09 12:01:50,019 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 12:01:50,020 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 12:01:50,020 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 12:01:50,021 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 12:01:50,022 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 12:01:50,022 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 12:01:50,023 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 12:01:50,023 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 12:01:50,024 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 12:03:24,206 - __main__ - INFO - 
2025-12-09 12:03:24,207 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:03:24,207 - __main__ - INFO - [DATA] Message data: {'report_id': '5027095a-f387-44e6-98bd-560c4e6bb072', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T04:03:24.1993178Z', 'report_type': 'cm_final_report'}
2025-12-09 12:03:24,211 - __main__ - INFO - 
2025-12-09 12:03:24,212 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 5027095a-f387-44e6-98bd-560c4e6bb072 (cm_reportform_signature_pdf)
2025-12-09 12:03:24,212 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 12:03:24,212 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:03:24,216 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "5027095a-f387-44e6-98bd-560c4e6bb072",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T12:03:24.212827"
}
2025-12-09 12:03:24,218 - __main__ - INFO - [STATUS UPDATE] 5027095a-f387-44e6-98bd-560c4e6bb072 -> PROCESSING - PDF generation started
2025-12-09 12:03:24,219 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 12:03:24,220 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:03:24,221 - __main__ - INFO - 
2025-12-09 12:03:24,222 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 12:03:24,223 - __main__ - INFO - 
2025-12-09 12:03:24,224 - __main__ - INFO - [STEP 4] Initializing CM PDF generator...
2025-12-09 12:03:24,226 - __main__ - INFO - 
2025-12-09 12:03:24,227 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:03:24,227 - __main__ - INFO - 
2025-12-09 12:03:24,228 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:03:24,355 - __main__ - INFO - 
2025-12-09 12:03:24,356 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 12:03:24,356 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 12:03:24,357 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 12:03:24,544 - __main__ - INFO - 
2025-12-09 12:03:24,545 - __main__ - INFO - [API] Response Status: 200
2025-12-09 12:03:24,546 - __main__ - INFO - 
2025-12-09 12:03:24,547 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3817 chars)
2025-12-09 12:03:24,547 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 12:03:24,550 - __main__ - INFO - 
2025-12-09 12:03:24,551 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 12:03:24,551 - __main__ - INFO - 
2025-12-09 12:03:24,552 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 12:03:24,552 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 12:03:24,766 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\5027095a-f387-44e6-98bd-560c4e6bb072\Signatures\20251209_120324_5b02164656694661bc7270782ab9a52f.png
2025-12-09 12:03:24,767 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\5027095a-f387-44e6-98bd-560c4e6bb072\Signatures\20251209_120324_d356b2bd08654247ae91ecdac6c90130.png
2025-12-09 12:03:24,768 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 12:03:24,768 - __main__ - INFO - 
2025-12-09 12:03:24,768 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 12:03:24,769 - __main__ - INFO - 
2025-12-09 12:03:24,769 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 12:03:24,853 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 12:03:26,216 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_120324.pdf
2025-12-09 12:03:26,217 - __main__ - INFO - 
2025-12-09 12:03:26,217 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_120324.pdf
2025-12-09 12:03:26,218 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:03:26,218 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "5027095a-f387-44e6-98bd-560c4e6bb072",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_120324.pdf",
  "timestamp": "2025-12-09T12:03:26.218366",
  "file_name": "CM_FinalReport_Report_10010001_20251209_120324.pdf"
}
2025-12-09 12:03:26,219 - __main__ - INFO - [STATUS UPDATE] 5027095a-f387-44e6-98bd-560c4e6bb072 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_120324.pdf
2025-12-09 12:03:26,220 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 12:03:26,221 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/5027095a-f387-44e6-98bd-560c4e6bb072
2025-12-09 12:04:17,352 - __main__ - INFO - 
2025-12-09 12:04:17,353 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 12:04:17,354 - __main__ - INFO - [DATA] Message data: {'report_id': '77bae073-2e15-46bd-b18d-9bf2671fa767', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T04:04:17.3472275Z'}
2025-12-09 12:04:17,359 - __main__ - INFO - 
2025-12-09 12:04:17,360 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767 (cm_reportform_pdf)
2025-12-09 12:04:17,360 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 12:04:17,361 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T12:04:17.360871"
}
2025-12-09 12:04:17,365 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> PROCESSING - PDF generation started
2025-12-09 12:04:17,366 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=9
2025-12-09 12:04:17,367 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 12:04:17,370 - __main__ - INFO - 
2025-12-09 12:04:17,372 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 12:04:17,373 - __main__ - INFO - 
2025-12-09 12:04:17,374 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 12:04:17,508 - __main__ - INFO - 
2025-12-09 12:04:17,509 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 12:04:17,510 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 12:04:17,511 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 12:04:17,692 - __main__ - INFO - 
2025-12-09 12:04:17,692 - __main__ - INFO - [API] Response Status: 200
2025-12-09 12:04:17,693 - __main__ - INFO - 
2025-12-09 12:04:17,694 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 1754 chars)
2025-12-09 12:04:17,694 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 12:04:17,697 - __main__ - INFO - 
2025-12-09 12:04:17,697 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 12:04:17,698 - __main__ - INFO - 
2025-12-09 12:04:17,698 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 12:04:17,699 - __main__ - INFO - 
2025-12-09 12:04:17,699 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 12:04:17,794 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_120417.pdf
2025-12-09 12:04:17,795 - __main__ - INFO - 
2025-12-09 12:04:17,795 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_120417.pdf
2025-12-09 12:04:17,795 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 12:04:17,796 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "completed",
  "message": "PDF generated successfully: CM_Report_10010002_20251209_120417.pdf",
  "timestamp": "2025-12-09T12:04:17.795746",
  "file_name": "CM_Report_10010002_20251209_120417.pdf"
}
2025-12-09 12:04:17,796 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> COMPLETED - PDF generated successfully: CM_Report_10010002_20251209_120417.pdf
2025-12-09 12:04:17,797 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=10
2025-12-09 12:04:17,797 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,120 - __main__ - INFO - 
2025-12-09 13:46:52,121 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,122 - __main__ - INFO - [DATA] Message data: {'report_id': '77bae073-2e15-46bd-b18d-9bf2671fa767', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T05:46:52.1174169Z'}
2025-12-09 13:46:52,131 - __main__ - INFO - 
2025-12-09 13:46:52,133 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767 (cm_reportform_pdf)
2025-12-09 13:46:52,135 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,137 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T13:46:52.135437"
}
2025-12-09 13:46:52,139 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> PROCESSING - PDF generation started
2025-12-09 13:46:52,140 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=11
2025-12-09 13:46:52,142 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,143 - __main__ - INFO - 
2025-12-09 13:46:52,143 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,144 - __main__ - INFO - 
2025-12-09 13:46:52,145 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,240 - __main__ - INFO - 
2025-12-09 13:46:52,241 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 13:46:52,242 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 13:46:52,242 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 13:46:52,407 - __main__ - INFO - 
2025-12-09 13:46:52,407 - __main__ - INFO - [API] Response Status: 200
2025-12-09 13:46:52,409 - __main__ - INFO - 
2025-12-09 13:46:52,410 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 1825 chars)
2025-12-09 13:46:52,410 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 13:46:52,413 - __main__ - INFO - 
2025-12-09 13:46:52,413 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 13:46:52,414 - __main__ - INFO - 
2025-12-09 13:46:52,414 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 13:46:52,415 - __main__ - INFO - 
2025-12-09 13:46:52,415 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 13:46:52,494 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_134652.pdf
2025-12-09 13:46:52,495 - __main__ - INFO - 
2025-12-09 13:46:52,495 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_134652.pdf
2025-12-09 13:46:52,495 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:46:52,496 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "completed",
  "message": "PDF generated successfully: CM_Report_10010002_20251209_134652.pdf",
  "timestamp": "2025-12-09T13:46:52.495762",
  "file_name": "CM_Report_10010002_20251209_134652.pdf"
}
2025-12-09 13:46:52,496 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> COMPLETED - PDF generated successfully: CM_Report_10010002_20251209_134652.pdf
2025-12-09 13:46:52,497 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=12
2025-12-09 13:46:52,497 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,377 - __main__ - INFO - 
2025-12-09 13:47:35,378 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,379 - __main__ - INFO - [DATA] Message data: {'report_id': '77bae073-2e15-46bd-b18d-9bf2671fa767', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T05:47:35.3754168Z'}
2025-12-09 13:47:35,383 - __main__ - INFO - 
2025-12-09 13:47:35,383 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767 (cm_reportform_pdf)
2025-12-09 13:47:35,384 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,384 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T13:47:35.384320"
}
2025-12-09 13:47:35,386 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> PROCESSING - PDF generation started
2025-12-09 13:47:35,386 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=13
2025-12-09 13:47:35,387 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,388 - __main__ - INFO - 
2025-12-09 13:47:35,388 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,389 - __main__ - INFO - 
2025-12-09 13:47:35,390 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,521 - __main__ - INFO - 
2025-12-09 13:47:35,524 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 13:47:35,526 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 13:47:35,527 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 13:47:35,753 - __main__ - INFO - 
2025-12-09 13:47:35,754 - __main__ - INFO - [API] Response Status: 200
2025-12-09 13:47:35,756 - __main__ - INFO - 
2025-12-09 13:47:35,757 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 1825 chars)
2025-12-09 13:47:35,758 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 13:47:35,762 - __main__ - INFO - 
2025-12-09 13:47:35,762 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 13:47:35,763 - __main__ - INFO - 
2025-12-09 13:47:35,764 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 13:47:35,764 - __main__ - INFO - 
2025-12-09 13:47:35,765 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 13:47:35,863 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_134735.pdf
2025-12-09 13:47:35,863 - __main__ - INFO - 
2025-12-09 13:47:35,864 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_134735.pdf
2025-12-09 13:47:35,864 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:47:35,864 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "completed",
  "message": "PDF generated successfully: CM_Report_10010002_20251209_134735.pdf",
  "timestamp": "2025-12-09T13:47:35.864578",
  "file_name": "CM_Report_10010002_20251209_134735.pdf"
}
2025-12-09 13:47:35,865 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> COMPLETED - PDF generated successfully: CM_Report_10010002_20251209_134735.pdf
2025-12-09 13:47:35,866 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=14
2025-12-09 13:47:35,866 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:48,511 - __main__ - INFO - 
2025-12-09 13:50:48,512 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:48,512 - __main__ - INFO - [DATA] Message data: {'report_id': '77bae073-2e15-46bd-b18d-9bf2671fa767', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T05:50:48.5095114Z'}
2025-12-09 13:50:48,517 - __main__ - INFO - 
2025-12-09 13:50:48,518 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767 (cm_reportform_pdf)
2025-12-09 13:50:48,518 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:48,519 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T13:50:48.518870"
}
2025-12-09 13:50:48,521 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> PROCESSING - PDF generation started
2025-12-09 13:50:48,522 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=15
2025-12-09 13:50:48,522 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:48,523 - __main__ - INFO - 
2025-12-09 13:50:48,525 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:48,525 - __main__ - INFO - 
2025-12-09 13:50:48,526 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:48,618 - __main__ - INFO - 
2025-12-09 13:50:48,618 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 13:50:48,619 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 13:50:48,619 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 13:50:48,808 - __main__ - INFO - 
2025-12-09 13:50:48,808 - __main__ - INFO - [API] Response Status: 200
2025-12-09 13:50:48,809 - __main__ - INFO - 
2025-12-09 13:50:48,809 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 2243 chars)
2025-12-09 13:50:48,810 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 13:50:48,812 - __main__ - INFO - 
2025-12-09 13:50:48,812 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 13:50:48,813 - __main__ - INFO - 
2025-12-09 13:50:48,813 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 13:50:48,814 - __main__ - INFO - 
2025-12-09 13:50:48,814 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 13:50:49,329 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_135048.pdf
2025-12-09 13:50:49,330 - __main__ - INFO - 
2025-12-09 13:50:49,330 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_Report_10010002_20251209_135048.pdf
2025-12-09 13:50:49,333 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:50:49,333 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "completed",
  "message": "PDF generated successfully: CM_Report_10010002_20251209_135048.pdf",
  "timestamp": "2025-12-09T13:50:49.332966",
  "file_name": "CM_Report_10010002_20251209_135048.pdf"
}
2025-12-09 13:50:49,335 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> COMPLETED - PDF generated successfully: CM_Report_10010002_20251209_135048.pdf
2025-12-09 13:50:49,335 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=16
2025-12-09 13:50:49,336 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:26,564 - __main__ - INFO - 
2025-12-09 13:52:26,565 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:26,566 - __main__ - INFO - [DATA] Message data: {'report_id': '77bae073-2e15-46bd-b18d-9bf2671fa767', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T05:52:26.5562566Z', 'report_type': 'cm_final_report'}
2025-12-09 13:52:26,572 - __main__ - INFO - 
2025-12-09 13:52:26,573 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 77bae073-2e15-46bd-b18d-9bf2671fa767 (cm_reportform_signature_pdf)
2025-12-09 13:52:26,573 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 13:52:26,575 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:26,576 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T13:52:26.575330"
}
2025-12-09 13:52:26,579 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> PROCESSING - PDF generation started
2025-12-09 13:52:26,580 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=17
2025-12-09 13:52:26,581 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:26,582 - __main__ - INFO - 
2025-12-09 13:52:26,584 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:26,585 - __main__ - INFO - 
2025-12-09 13:52:26,586 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:26,709 - __main__ - INFO - 
2025-12-09 13:52:26,709 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 13:52:26,710 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 13:52:26,710 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 13:52:26,908 - __main__ - INFO - 
2025-12-09 13:52:26,908 - __main__ - INFO - [API] Response Status: 200
2025-12-09 13:52:26,909 - __main__ - INFO - 
2025-12-09 13:52:26,910 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3522 chars)
2025-12-09 13:52:26,910 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 13:52:26,913 - __main__ - INFO - 
2025-12-09 13:52:26,913 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 13:52:26,914 - __main__ - INFO - 
2025-12-09 13:52:26,914 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 13:52:26,915 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 13:52:26,978 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\77bae073-2e15-46bd-b18d-9bf2671fa767\Signatures\20251209_135226_06ea2fcb84f34c0abf9d2af97a86a393.png
2025-12-09 13:52:26,979 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\77bae073-2e15-46bd-b18d-9bf2671fa767\Signatures\20251209_135226_f17296e6a24740ad87b00ef1fd370afb.png
2025-12-09 13:52:26,980 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 13:52:26,981 - __main__ - INFO - 
2025-12-09 13:52:26,981 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 13:52:26,982 - __main__ - INFO - 
2025-12-09 13:52:26,982 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 13:52:26,996 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 13:52:28,041 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010002_20251209_135226.pdf
2025-12-09 13:52:28,042 - __main__ - INFO - 
2025-12-09 13:52:28,043 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010002_20251209_135226.pdf
2025-12-09 13:52:28,043 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:52:28,044 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "77bae073-2e15-46bd-b18d-9bf2671fa767",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010002_20251209_135226.pdf",
  "timestamp": "2025-12-09T13:52:28.043601",
  "file_name": "CM_FinalReport_Report_10010002_20251209_135226.pdf"
}
2025-12-09 13:52:28,045 - __main__ - INFO - [STATUS UPDATE] 77bae073-2e15-46bd-b18d-9bf2671fa767 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010002_20251209_135226.pdf
2025-12-09 13:52:28,046 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=18
2025-12-09 13:52:28,046 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/77bae073-2e15-46bd-b18d-9bf2671fa767
2025-12-09 13:55:11,321 - __main__ - INFO - 
2025-12-09 13:55:11,322 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 13:55:11,323 - __main__ - INFO - [DATA] Message data: {'report_id': '121e089d-6d08-4896-95f2-72165f8448a9', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T05:55:11.2205055Z', 'report_type': 'cm_final_report'}
2025-12-09 13:55:11,328 - __main__ - INFO - 
2025-12-09 13:55:11,329 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 121e089d-6d08-4896-95f2-72165f8448a9 (cm_reportform_signature_pdf)
2025-12-09 13:55:11,329 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 13:55:11,330 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 13:55:11,331 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "121e089d-6d08-4896-95f2-72165f8448a9",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T13:55:11.330431"
}
2025-12-09 13:55:11,332 - __main__ - INFO - [STATUS UPDATE] 121e089d-6d08-4896-95f2-72165f8448a9 -> PROCESSING - PDF generation started
2025-12-09 13:55:11,333 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=19
2025-12-09 13:55:11,334 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 13:55:11,334 - __main__ - INFO - 
2025-12-09 13:55:11,334 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 13:55:11,335 - __main__ - INFO - 
2025-12-09 13:55:11,336 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 13:55:11,437 - __main__ - INFO - 
2025-12-09 13:55:11,438 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 13:55:11,438 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 13:55:11,438 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 13:55:11,601 - __main__ - INFO - 
2025-12-09 13:55:11,602 - __main__ - INFO - [API] Response Status: 200
2025-12-09 13:55:11,603 - __main__ - INFO - 
2025-12-09 13:55:11,603 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3494 chars)
2025-12-09 13:55:11,604 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 13:55:11,605 - __main__ - INFO - 
2025-12-09 13:55:11,606 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 13:55:11,606 - __main__ - INFO - 
2025-12-09 13:55:11,607 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 13:55:11,607 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 13:55:11,654 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\121e089d-6d08-4896-95f2-72165f8448a9\Signatures\20251209_135510_1b7cfab78ba14755a64095653018e366.png
2025-12-09 13:55:11,655 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\121e089d-6d08-4896-95f2-72165f8448a9\Signatures\20251209_135510_9691c6e032374cc28a9f236d9a0f720c.png
2025-12-09 13:55:11,656 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 13:55:11,657 - __main__ - INFO - 
2025-12-09 13:55:11,657 - __main__ - INFO - [STEP 7] Using job number: 10010003
2025-12-09 13:55:11,658 - __main__ - INFO - 
2025-12-09 13:55:11,658 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 13:55:11,691 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 13:55:12,729 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010003_20251209_135511.pdf
2025-12-09 13:55:12,730 - __main__ - INFO - 
2025-12-09 13:55:12,730 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010003_20251209_135511.pdf
2025-12-09 13:55:12,731 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 13:55:12,733 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "121e089d-6d08-4896-95f2-72165f8448a9",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010003_20251209_135511.pdf",
  "timestamp": "2025-12-09T13:55:12.731573",
  "file_name": "CM_FinalReport_Report_10010003_20251209_135511.pdf"
}
2025-12-09 13:55:12,735 - __main__ - INFO - [STATUS UPDATE] 121e089d-6d08-4896-95f2-72165f8448a9 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010003_20251209_135511.pdf
2025-12-09 13:55:12,736 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=20
2025-12-09 13:55:12,737 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/121e089d-6d08-4896-95f2-72165f8448a9
2025-12-09 14:00:21,258 - __main__ - INFO - 
2025-12-09 14:00:21,258 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:00:21,259 - __main__ - INFO - [DATA] Message data: {'report_id': '25f06ceb-64fd-4ddc-a944-d53bd3e26634', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T06:00:21.2525939Z', 'report_type': 'cm_final_report'}
2025-12-09 14:00:21,263 - __main__ - INFO - 
2025-12-09 14:00:21,264 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 25f06ceb-64fd-4ddc-a944-d53bd3e26634 (cm_reportform_signature_pdf)
2025-12-09 14:00:21,264 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 14:00:21,265 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:00:21,266 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "25f06ceb-64fd-4ddc-a944-d53bd3e26634",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T14:00:21.265513"
}
2025-12-09 14:00:21,268 - __main__ - INFO - [STATUS UPDATE] 25f06ceb-64fd-4ddc-a944-d53bd3e26634 -> PROCESSING - PDF generation started
2025-12-09 14:00:21,269 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=21
2025-12-09 14:00:21,270 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:00:21,271 - __main__ - INFO - 
2025-12-09 14:00:21,272 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:00:21,272 - __main__ - INFO - 
2025-12-09 14:00:21,272 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:00:21,370 - __main__ - INFO - 
2025-12-09 14:00:21,371 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 14:00:21,372 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 14:00:21,372 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 14:00:21,589 - __main__ - INFO - 
2025-12-09 14:00:21,590 - __main__ - INFO - [API] Response Status: 200
2025-12-09 14:00:21,591 - __main__ - INFO - 
2025-12-09 14:00:21,591 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 4279 chars)
2025-12-09 14:00:21,592 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 14:00:21,594 - __main__ - INFO - 
2025-12-09 14:00:21,595 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 14:00:21,596 - __main__ - INFO - 
2025-12-09 14:00:21,596 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 14:00:21,597 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 14:00:21,642 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\25f06ceb-64fd-4ddc-a944-d53bd3e26634\Signatures\20251209_140021_aaa7c2f17be7485380cfe14562c7a0b1.png
2025-12-09 14:00:21,643 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\25f06ceb-64fd-4ddc-a944-d53bd3e26634\Signatures\20251209_140021_f31ada76bea241e6a6d56c935e678554.png
2025-12-09 14:00:21,644 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 14:00:21,645 - __main__ - INFO - 
2025-12-09 14:00:21,645 - __main__ - INFO - [STEP 7] Using job number: 10010004
2025-12-09 14:00:21,646 - __main__ - INFO - 
2025-12-09 14:00:21,646 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 14:00:21,680 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 14:00:23,417 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010004_20251209_140021.pdf
2025-12-09 14:00:23,418 - __main__ - INFO - 
2025-12-09 14:00:23,418 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010004_20251209_140021.pdf
2025-12-09 14:00:23,419 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:00:23,419 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "25f06ceb-64fd-4ddc-a944-d53bd3e26634",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010004_20251209_140021.pdf",
  "timestamp": "2025-12-09T14:00:23.419053",
  "file_name": "CM_FinalReport_Report_10010004_20251209_140021.pdf"
}
2025-12-09 14:00:23,420 - __main__ - INFO - [STATUS UPDATE] 25f06ceb-64fd-4ddc-a944-d53bd3e26634 -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010004_20251209_140021.pdf
2025-12-09 14:00:23,420 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=22
2025-12-09 14:00:23,421 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/25f06ceb-64fd-4ddc-a944-d53bd3e26634
2025-12-09 14:08:14,983 - __main__ - INFO - 
2025-12-09 14:08:14,984 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:08:14,984 - __main__ - INFO - [DATA] Message data: {'report_id': 'f7826e83-fe12-40c7-a52e-7767b93a9e0e', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T06:08:14.9752239Z', 'report_type': 'cm_final_report'}
2025-12-09 14:08:14,991 - __main__ - INFO - 
2025-12-09 14:08:14,991 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: f7826e83-fe12-40c7-a52e-7767b93a9e0e (cm_reportform_signature_pdf)
2025-12-09 14:08:14,992 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 14:08:14,993 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:08:14,993 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "f7826e83-fe12-40c7-a52e-7767b93a9e0e",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T14:08:14.993051"
}
2025-12-09 14:08:14,995 - __main__ - INFO - [STATUS UPDATE] f7826e83-fe12-40c7-a52e-7767b93a9e0e -> PROCESSING - PDF generation started
2025-12-09 14:08:14,996 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=23
2025-12-09 14:08:14,997 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:08:14,997 - __main__ - INFO - 
2025-12-09 14:08:14,998 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/CMReportForm/f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:08:14,999 - __main__ - INFO - 
2025-12-09 14:08:14,999 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/CMReportForm/f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:08:15,084 - __main__ - INFO - 
2025-12-09 14:08:15,085 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 14:08:15,086 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 14:08:15,087 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 14:08:15,253 - __main__ - INFO - 
2025-12-09 14:08:15,253 - __main__ - INFO - [API] Response Status: 200
2025-12-09 14:08:15,254 - __main__ - INFO - 
2025-12-09 14:08:15,255 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 5408 chars)
2025-12-09 14:08:15,255 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'cmReportForm', 'materialUsed', 'beforeIssueImages', 'afterActionImages', 'materialUsedOldSerialImages', 'materialUsedNewSerialImages']
2025-12-09 14:08:15,258 - __main__ - INFO - 
2025-12-09 14:08:15,259 - __main__ - INFO - [STEP 6] Transforming API data for report type cm_reportform_pdf...
2025-12-09 14:08:15,259 - __main__ - INFO - 
2025-12-09 14:08:15,260 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 14:08:15,260 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 14:08:15,309 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\f7826e83-fe12-40c7-a52e-7767b93a9e0e\Signatures\20251209_140814_45dc7b238b4343f4acbaeb265e5e2f2b.png
2025-12-09 14:08:15,310 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\f7826e83-fe12-40c7-a52e-7767b93a9e0e\Signatures\20251209_140814_16996be21cd242269b07479436af6371.png
2025-12-09 14:08:15,311 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 14:08:15,311 - __main__ - INFO - 
2025-12-09 14:08:15,311 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 14:08:15,312 - __main__ - INFO - 
2025-12-09 14:08:15,313 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 14:08:15,350 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Adding signature images section to final report
2025-12-09 14:08:17,688 - CM_Report.cm_pdf_generator - INFO - [CM PDF] Generated CM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_140815.pdf
2025-12-09 14:08:17,689 - __main__ - INFO - 
2025-12-09 14:08:17,689 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\CM_FinalReport_Report_10010001_20251209_140815.pdf
2025-12-09 14:08:17,690 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/cm_reportform_signature_pdf_status/f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:08:17,690 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "f7826e83-fe12-40c7-a52e-7767b93a9e0e",
  "status": "completed",
  "message": "PDF generated successfully: CM_FinalReport_Report_10010001_20251209_140815.pdf",
  "timestamp": "2025-12-09T14:08:17.690350",
  "file_name": "CM_FinalReport_Report_10010001_20251209_140815.pdf"
}
2025-12-09 14:08:17,692 - __main__ - INFO - [STATUS UPDATE] f7826e83-fe12-40c7-a52e-7767b93a9e0e -> COMPLETED - PDF generated successfully: CM_FinalReport_Report_10010001_20251209_140815.pdf
2025-12-09 14:08:17,692 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=24
2025-12-09 14:08:17,693 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/cm_reportform_signature_pdf_status/f7826e83-fe12-40c7-a52e-7767b93a9e0e
2025-12-09 14:19:59,283 - __main__ - INFO - 
2025-12-09 14:19:59,284 - __main__ - INFO - Cleaning up resources...
2025-12-09 14:20:03,852 - __main__ - INFO - 
2025-12-09 14:20:03,852 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 14:20:03,853 - __main__ - INFO - 
2025-12-09 14:20:03,853 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 14:20:03,854 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 14:20:03,854 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 14:20:03,854 - __main__ - INFO - Authenticating with API...
2025-12-09 14:20:03,854 - __main__ - INFO - 
2025-12-09 14:20:03,855 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 14:20:03,884 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 14:20:03,885 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 14:20:04,306 - __main__ - INFO - 
2025-12-09 14:20:04,306 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 14:20:04,307 - __main__ - INFO - 
2025-12-09 14:20:04,307 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 14:20:04,308 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T06:20:04.3047623Z
2025-12-09 14:20:04,310 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 14:20:04,329 - __main__ - INFO - 
2025-12-09 14:20:04,330 - __main__ - INFO - 
2025-12-09 14:20:04,330 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 14:20:04,331 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 14:20:04,331 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 14:20:04,331 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 14:20:04,332 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 14:20:04,333 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 14:20:04,333 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 14:20:04,334 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 14:20:04,335 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 14:24:58,511 - __main__ - INFO - 
2025-12-09 14:24:58,511 - __main__ - INFO - Cleaning up resources...
2025-12-09 14:24:58,568 - __main__ - INFO - MQTT client disconnected
2025-12-09 14:24:58,570 - __main__ - INFO - 
2025-12-09 14:24:58,570 - __main__ - INFO - Cleanup completed
2025-12-09 14:25:01,675 - __main__ - INFO - 
2025-12-09 14:25:01,675 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 14:25:01,676 - __main__ - INFO - 
2025-12-09 14:25:01,677 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 14:25:01,677 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 14:25:01,677 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 14:25:01,677 - __main__ - INFO - Authenticating with API...
2025-12-09 14:25:01,677 - __main__ - INFO - 
2025-12-09 14:25:01,677 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 14:25:01,707 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 14:25:01,707 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 14:25:02,080 - __main__ - INFO - 
2025-12-09 14:25:02,081 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 14:25:02,081 - __main__ - INFO - 
2025-12-09 14:25:02,082 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 14:25:02,082 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T06:25:02.0792789Z
2025-12-09 14:25:02,084 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 14:25:02,101 - __main__ - INFO - 
2025-12-09 14:25:02,101 - __main__ - INFO - 
2025-12-09 14:25:02,102 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 14:25:02,102 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 14:25:02,102 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 14:25:02,104 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 14:25:02,107 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 14:25:02,109 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 14:25:02,110 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 14:25:02,110 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 14:25:02,111 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 14:45:01,638 - __main__ - INFO - 
2025-12-09 14:45:01,639 - __main__ - INFO - Cleaning up resources...
2025-12-09 14:45:05,005 - __main__ - INFO - 
2025-12-09 14:45:05,005 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 14:45:05,006 - __main__ - INFO - 
2025-12-09 14:45:05,006 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 14:45:05,007 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 14:45:05,007 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 14:45:05,007 - __main__ - INFO - Authenticating with API...
2025-12-09 14:45:05,007 - __main__ - INFO - 
2025-12-09 14:45:05,007 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 14:45:05,046 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 14:45:05,046 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 14:45:06,471 - __main__ - INFO - 
2025-12-09 14:45:06,472 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 14:45:06,472 - __main__ - INFO - 
2025-12-09 14:45:06,473 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 14:45:06,473 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T06:45:06.4605362Z
2025-12-09 14:45:06,475 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 14:45:06,489 - __main__ - INFO - 
2025-12-09 14:45:06,489 - __main__ - INFO - 
2025-12-09 14:45:06,489 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 14:45:06,490 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 14:45:06,491 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 14:45:06,492 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 14:45:06,493 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 14:45:06,493 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 14:45:06,494 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 14:45:06,495 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 14:45:06,495 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 14:45:13,253 - __main__ - INFO - 
2025-12-09 14:45:13,254 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:45:13,255 - __main__ - INFO - [DATA] Message data: {'report_id': 'f5f81d6c-8e91-4338-bb8e-7470fdf448d1', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T06:45:13.2280332Z', 'report_type': 'rtu_pm_final_report'}
2025-12-09 14:45:13,260 - __main__ - INFO - 
2025-12-09 14:45:13,261 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: f5f81d6c-8e91-4338-bb8e-7470fdf448d1 (rtu_pm_reportform_signature_pdf)
2025-12-09 14:45:13,261 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 14:45:13,262 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:45:13,263 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "f5f81d6c-8e91-4338-bb8e-7470fdf448d1",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T14:45:13.262422"
}
2025-12-09 14:45:13,264 - __main__ - INFO - [STATUS UPDATE] f5f81d6c-8e91-4338-bb8e-7470fdf448d1 -> PROCESSING - PDF generation started
2025-12-09 14:45:13,266 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 14:45:13,270 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:45:13,271 - __main__ - INFO - 
2025-12-09 14:45:13,272 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 14:45:13,273 - __main__ - INFO - 
2025-12-09 14:45:13,274 - __main__ - INFO - [STEP 4] Initializing RTU PM PDF generator...
2025-12-09 14:45:13,277 - __main__ - INFO - 
2025-12-09 14:45:13,277 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/RTUPMReportForm/f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:45:13,278 - __main__ - INFO - 
2025-12-09 14:45:13,279 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/RTUPMReportForm/f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:45:13,401 - __main__ - INFO - 
2025-12-09 14:45:13,402 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 14:45:13,403 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 14:45:13,403 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 14:45:14,188 - __main__ - INFO - 
2025-12-09 14:45:14,189 - __main__ - INFO - [API] Response Status: 200
2025-12-09 14:45:14,190 - __main__ - INFO - 
2025-12-09 14:45:14,190 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 5242 chars)
2025-12-09 14:45:14,191 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'pmReportFormRTU', 'pmMainRtuCabinet', 'pmChamberMagneticContact', 'pmrtuCabinetCooling', 'pmdvrEquipment', 'pmMainRtuCabinetImages', 'pmChamberMagneticContactImages', 'pmrtuCabinetCoolingImages', 'pmdvrEquipmentImages']
2025-12-09 14:45:14,193 - __main__ - INFO - 
2025-12-09 14:45:14,194 - __main__ - INFO - [STEP 6] Transforming API data for report type rtu_pm_reportform_pdf...
2025-12-09 14:45:14,194 - __main__ - INFO - 
2025-12-09 14:45:14,195 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 14:45:14,195 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 14:45:14,491 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\f5f81d6c-8e91-4338-bb8e-7470fdf448d1\Signatures\20251209_144512_54cb3f629dca42b7bff3a9fe2e9c91bf.png
2025-12-09 14:45:14,492 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\f5f81d6c-8e91-4338-bb8e-7470fdf448d1\Signatures\20251209_144512_6d72d99e948c4155b39f6b86d74e372a.png
2025-12-09 14:45:14,493 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 14:45:14,493 - __main__ - INFO - 
2025-12-09 14:45:14,494 - __main__ - INFO - [STEP 7] Using job number: 10010003
2025-12-09 14:45:14,495 - __main__ - INFO - 
2025-12-09 14:45:14,495 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 14:45:14,503 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Adding signature images section to final report
2025-12-09 14:45:15,535 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Generated RTU PM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010003_20251209_144514.pdf
2025-12-09 14:45:15,536 - __main__ - INFO - 
2025-12-09 14:45:15,536 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010003_20251209_144514.pdf
2025-12-09 14:45:15,537 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:45:15,537 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "f5f81d6c-8e91-4338-bb8e-7470fdf448d1",
  "status": "completed",
  "message": "PDF generated successfully: RTU_PM_FinalReport_Report_10010003_20251209_144514.pdf",
  "timestamp": "2025-12-09T14:45:15.537372",
  "file_name": "RTU_PM_FinalReport_Report_10010003_20251209_144514.pdf"
}
2025-12-09 14:45:15,539 - __main__ - INFO - [STATUS UPDATE] f5f81d6c-8e91-4338-bb8e-7470fdf448d1 -> COMPLETED - PDF generated successfully: RTU_PM_FinalReport_Report_10010003_20251209_144514.pdf
2025-12-09 14:45:15,539 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 14:45:15,540 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/f5f81d6c-8e91-4338-bb8e-7470fdf448d1
2025-12-09 14:47:39,848 - __main__ - INFO - 
2025-12-09 14:47:39,848 - __main__ - INFO - Cleaning up resources...
2025-12-09 14:47:45,405 - __main__ - INFO - 
2025-12-09 14:47:45,414 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-09 14:47:45,415 - __main__ - INFO - 
2025-12-09 14:47:45,417 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-09 14:47:45,420 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-09 14:47:45,421 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-09 14:47:45,422 - __main__ - INFO - Authenticating with API...
2025-12-09 14:47:45,426 - __main__ - INFO - 
2025-12-09 14:47:45,430 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-09 14:47:45,566 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-09 14:47:45,567 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-09 14:47:46,290 - __main__ - INFO - 
2025-12-09 14:47:46,291 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-09 14:47:46,292 - __main__ - INFO - 
2025-12-09 14:47:46,292 - __main__ - INFO - [AUTH] Authentication successful
2025-12-09 14:47:46,293 - __main__ - INFO - [AUTH] Token expires at: 2025-12-10T06:47:46.2889583Z
2025-12-09 14:47:46,296 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-09 14:47:46,303 - __main__ - INFO - 
2025-12-09 14:47:46,304 - __main__ - INFO - 
2025-12-09 14:47:46,304 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-09 14:47:46,305 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-09 14:47:46,306 - __main__ - INFO - Waiting for MQTT messages...
2025-12-09 14:47:46,307 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-09 14:47:46,308 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-09 14:47:46,310 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-09 14:47:46,311 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-09 14:47:46,313 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-09 14:47:46,314 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-09 14:49:28,330 - __main__ - INFO - 
2025-12-09 14:49:28,331 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:49:28,331 - __main__ - INFO - [DATA] Message data: {'report_id': 'ea79f37c-5b6b-419f-bac8-5da393003a9e', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T06:49:28.3212450Z', 'report_type': 'rtu_pm_final_report'}
2025-12-09 14:49:28,335 - __main__ - INFO - 
2025-12-09 14:49:28,336 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: ea79f37c-5b6b-419f-bac8-5da393003a9e (rtu_pm_reportform_signature_pdf)
2025-12-09 14:49:28,337 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 14:49:28,337 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:49:28,338 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "ea79f37c-5b6b-419f-bac8-5da393003a9e",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T14:49:28.337607"
}
2025-12-09 14:49:28,342 - __main__ - INFO - [STATUS UPDATE] ea79f37c-5b6b-419f-bac8-5da393003a9e -> PROCESSING - PDF generation started
2025-12-09 14:49:28,345 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-09 14:49:28,347 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:49:28,348 - __main__ - INFO - 
2025-12-09 14:49:28,348 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-09 14:49:28,349 - __main__ - INFO - 
2025-12-09 14:49:28,349 - __main__ - INFO - [STEP 4] Initializing RTU PM PDF generator...
2025-12-09 14:49:28,351 - __main__ - INFO - 
2025-12-09 14:49:28,352 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/RTUPMReportForm/ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:49:28,353 - __main__ - INFO - 
2025-12-09 14:49:28,353 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/RTUPMReportForm/ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:49:28,528 - __main__ - INFO - 
2025-12-09 14:49:28,529 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 14:49:28,530 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 14:49:28,530 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 14:49:28,865 - __main__ - INFO - 
2025-12-09 14:49:28,866 - __main__ - INFO - [API] Response Status: 200
2025-12-09 14:49:28,867 - __main__ - INFO - 
2025-12-09 14:49:28,868 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 5271 chars)
2025-12-09 14:49:28,868 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'pmReportFormRTU', 'pmMainRtuCabinet', 'pmChamberMagneticContact', 'pmrtuCabinetCooling', 'pmdvrEquipment', 'pmMainRtuCabinetImages', 'pmChamberMagneticContactImages', 'pmrtuCabinetCoolingImages', 'pmdvrEquipmentImages']
2025-12-09 14:49:28,872 - __main__ - INFO - 
2025-12-09 14:49:28,874 - __main__ - INFO - [STEP 6] Transforming API data for report type rtu_pm_reportform_pdf...
2025-12-09 14:49:28,877 - __main__ - INFO - 
2025-12-09 14:49:28,878 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 14:49:28,880 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 14:49:29,201 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\ea79f37c-5b6b-419f-bac8-5da393003a9e\Signatures\20251209_144928_e75944136a9e4d49bc3a4068561b5b4e.png
2025-12-09 14:49:29,202 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\ea79f37c-5b6b-419f-bac8-5da393003a9e\Signatures\20251209_144928_cd64338e59864b4a87ae03990f6d1342.png
2025-12-09 14:49:29,204 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 14:49:29,204 - __main__ - INFO - 
2025-12-09 14:49:29,205 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 14:49:29,205 - __main__ - INFO - 
2025-12-09 14:49:29,206 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 14:49:29,326 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Adding signature images to final summary page
2025-12-09 14:49:30,022 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Generated RTU PM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010001_20251209_144929.pdf
2025-12-09 14:49:30,023 - __main__ - INFO - 
2025-12-09 14:49:30,024 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010001_20251209_144929.pdf
2025-12-09 14:49:30,024 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:49:30,025 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "ea79f37c-5b6b-419f-bac8-5da393003a9e",
  "status": "completed",
  "message": "PDF generated successfully: RTU_PM_FinalReport_Report_10010001_20251209_144929.pdf",
  "timestamp": "2025-12-09T14:49:30.024606",
  "file_name": "RTU_PM_FinalReport_Report_10010001_20251209_144929.pdf"
}
2025-12-09 14:49:30,026 - __main__ - INFO - [STATUS UPDATE] ea79f37c-5b6b-419f-bac8-5da393003a9e -> COMPLETED - PDF generated successfully: RTU_PM_FinalReport_Report_10010001_20251209_144929.pdf
2025-12-09 14:49:30,026 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-09 14:49:30,027 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/ea79f37c-5b6b-419f-bac8-5da393003a9e
2025-12-09 14:53:00,498 - __main__ - INFO - 
2025-12-09 14:53:00,501 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 14:53:00,502 - __main__ - INFO - [DATA] Message data: {'report_id': 'a4def84a-9471-4e5d-aa7f-474e66d5164e', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T06:53:00.4808339Z', 'report_type': 'rtu_pm_final_report'}
2025-12-09 14:53:00,514 - __main__ - INFO - 
2025-12-09 14:53:00,515 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: a4def84a-9471-4e5d-aa7f-474e66d5164e (rtu_pm_reportform_signature_pdf)
2025-12-09 14:53:00,519 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 14:53:00,521 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 14:53:00,523 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a4def84a-9471-4e5d-aa7f-474e66d5164e",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T14:53:00.520911"
}
2025-12-09 14:53:00,526 - __main__ - INFO - [STATUS UPDATE] a4def84a-9471-4e5d-aa7f-474e66d5164e -> PROCESSING - PDF generation started
2025-12-09 14:53:00,529 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=9
2025-12-09 14:53:00,530 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 14:53:00,532 - __main__ - INFO - 
2025-12-09 14:53:00,536 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/RTUPMReportForm/a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 14:53:00,538 - __main__ - INFO - 
2025-12-09 14:53:00,540 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/RTUPMReportForm/a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 14:53:00,724 - __main__ - INFO - 
2025-12-09 14:53:00,725 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 14:53:00,725 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 14:53:00,726 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 14:53:01,215 - __main__ - INFO - 
2025-12-09 14:53:01,217 - __main__ - INFO - [API] Response Status: 200
2025-12-09 14:53:01,220 - __main__ - INFO - 
2025-12-09 14:53:01,222 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 5329 chars)
2025-12-09 14:53:01,223 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'pmReportFormRTU', 'pmMainRtuCabinet', 'pmChamberMagneticContact', 'pmrtuCabinetCooling', 'pmdvrEquipment', 'pmMainRtuCabinetImages', 'pmChamberMagneticContactImages', 'pmrtuCabinetCoolingImages', 'pmdvrEquipmentImages']
2025-12-09 14:53:01,229 - __main__ - INFO - 
2025-12-09 14:53:01,230 - __main__ - INFO - [STEP 6] Transforming API data for report type rtu_pm_reportform_pdf...
2025-12-09 14:53:01,232 - __main__ - INFO - 
2025-12-09 14:53:01,236 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 14:53:01,238 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 14:53:01,326 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a4def84a-9471-4e5d-aa7f-474e66d5164e\Signatures\20251209_145300_e559b922d6864812bd2d94a5eb363cd3.png
2025-12-09 14:53:01,327 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a4def84a-9471-4e5d-aa7f-474e66d5164e\Signatures\20251209_145259_ec726c11abe445b89ea9db37db8fbc56.png
2025-12-09 14:53:01,328 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 14:53:01,329 - __main__ - INFO - 
2025-12-09 14:53:01,329 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-09 14:53:01,330 - __main__ - INFO - 
2025-12-09 14:53:01,330 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 14:53:01,384 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Adding signature images to final summary page
2025-12-09 14:53:02,235 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Generated RTU PM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010002_20251209_145301.pdf
2025-12-09 14:53:02,237 - __main__ - INFO - 
2025-12-09 14:53:02,238 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010002_20251209_145301.pdf
2025-12-09 14:53:02,239 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 14:53:02,240 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a4def84a-9471-4e5d-aa7f-474e66d5164e",
  "status": "completed",
  "message": "PDF generated successfully: RTU_PM_FinalReport_Report_10010002_20251209_145301.pdf",
  "timestamp": "2025-12-09T14:53:02.239876",
  "file_name": "RTU_PM_FinalReport_Report_10010002_20251209_145301.pdf"
}
2025-12-09 14:53:02,242 - __main__ - INFO - [STATUS UPDATE] a4def84a-9471-4e5d-aa7f-474e66d5164e -> COMPLETED - PDF generated successfully: RTU_PM_FinalReport_Report_10010002_20251209_145301.pdf
2025-12-09 14:53:02,243 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=10
2025-12-09 14:53:02,244 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/a4def84a-9471-4e5d-aa7f-474e66d5164e
2025-12-09 15:11:05,317 - __main__ - INFO - 
2025-12-09 15:11:05,318 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:11:05,319 - __main__ - INFO - [DATA] Message data: {'report_id': 'ef2b145a-a763-4858-847b-4451908b7758', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T07:11:05.3088577Z', 'report_type': 'rtu_pm_final_report'}
2025-12-09 15:11:05,325 - __main__ - INFO - 
2025-12-09 15:11:05,328 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: ef2b145a-a763-4858-847b-4451908b7758 (rtu_pm_reportform_signature_pdf)
2025-12-09 15:11:05,328 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 15:11:05,329 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:11:05,330 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "ef2b145a-a763-4858-847b-4451908b7758",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T15:11:05.329395"
}
2025-12-09 15:11:05,331 - __main__ - INFO - [STATUS UPDATE] ef2b145a-a763-4858-847b-4451908b7758 -> PROCESSING - PDF generation started
2025-12-09 15:11:05,332 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=11
2025-12-09 15:11:05,334 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:11:05,335 - __main__ - INFO - 
2025-12-09 15:11:05,335 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/RTUPMReportForm/ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:11:05,336 - __main__ - INFO - 
2025-12-09 15:11:05,337 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/RTUPMReportForm/ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:11:05,443 - __main__ - INFO - 
2025-12-09 15:11:05,444 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 15:11:05,444 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 15:11:05,445 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 15:11:05,728 - __main__ - INFO - 
2025-12-09 15:11:05,729 - __main__ - INFO - [API] Response Status: 200
2025-12-09 15:11:05,730 - __main__ - INFO - 
2025-12-09 15:11:05,731 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 8713 chars)
2025-12-09 15:11:05,731 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'pmReportFormRTU', 'pmMainRtuCabinet', 'pmChamberMagneticContact', 'pmrtuCabinetCooling', 'pmdvrEquipment', 'pmMainRtuCabinetImages', 'pmChamberMagneticContactImages', 'pmrtuCabinetCoolingImages', 'pmdvrEquipmentImages']
2025-12-09 15:11:05,734 - __main__ - INFO - 
2025-12-09 15:11:05,735 - __main__ - INFO - [STEP 6] Transforming API data for report type rtu_pm_reportform_pdf...
2025-12-09 15:11:05,735 - __main__ - INFO - 
2025-12-09 15:11:05,736 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 15:11:05,737 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 15:11:05,815 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\ef2b145a-a763-4858-847b-4451908b7758\Signatures\20251209_151105_541a79f1f9cb4e94b885b7832e84a32f.png
2025-12-09 15:11:05,815 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\ef2b145a-a763-4858-847b-4451908b7758\Signatures\20251209_151105_a37d6996c56c412883ec452ae9eeb211.png
2025-12-09 15:11:05,816 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 15:11:05,816 - __main__ - INFO - 
2025-12-09 15:11:05,817 - __main__ - INFO - [STEP 7] Using job number: 10010003
2025-12-09 15:11:05,817 - __main__ - INFO - 
2025-12-09 15:11:05,817 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 15:11:05,861 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Adding signature images to final summary page
2025-12-09 15:11:07,095 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Generated RTU PM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010003_20251209_151105.pdf
2025-12-09 15:11:07,096 - __main__ - INFO - 
2025-12-09 15:11:07,097 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010003_20251209_151105.pdf
2025-12-09 15:11:07,097 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:11:07,098 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "ef2b145a-a763-4858-847b-4451908b7758",
  "status": "completed",
  "message": "PDF generated successfully: RTU_PM_FinalReport_Report_10010003_20251209_151105.pdf",
  "timestamp": "2025-12-09T15:11:07.097560",
  "file_name": "RTU_PM_FinalReport_Report_10010003_20251209_151105.pdf"
}
2025-12-09 15:11:07,099 - __main__ - INFO - [STATUS UPDATE] ef2b145a-a763-4858-847b-4451908b7758 -> COMPLETED - PDF generated successfully: RTU_PM_FinalReport_Report_10010003_20251209_151105.pdf
2025-12-09 15:11:07,099 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=12
2025-12-09 15:11:07,100 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/ef2b145a-a763-4858-847b-4451908b7758
2025-12-09 15:31:00,420 - __main__ - INFO - 
2025-12-09 15:31:00,421 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 15:31:00,421 - __main__ - INFO - [DATA] Message data: {'report_id': 'a2691f20-d26a-4e6c-b3e7-f85e060aec4b', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T07:31:00.4145466Z', 'report_type': 'rtu_pm_final_report'}
2025-12-09 15:31:00,427 - __main__ - INFO - 
2025-12-09 15:31:00,429 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: a2691f20-d26a-4e6c-b3e7-f85e060aec4b (rtu_pm_reportform_signature_pdf)
2025-12-09 15:31:00,429 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 15:31:00,430 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 15:31:00,430 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a2691f20-d26a-4e6c-b3e7-f85e060aec4b",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T15:31:00.429876"
}
2025-12-09 15:31:00,431 - __main__ - INFO - [STATUS UPDATE] a2691f20-d26a-4e6c-b3e7-f85e060aec4b -> PROCESSING - PDF generation started
2025-12-09 15:31:00,432 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=13
2025-12-09 15:31:00,433 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 15:31:00,433 - __main__ - INFO - 
2025-12-09 15:31:00,434 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/RTUPMReportForm/a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 15:31:00,436 - __main__ - INFO - 
2025-12-09 15:31:00,436 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/RTUPMReportForm/a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 15:31:00,549 - __main__ - INFO - 
2025-12-09 15:31:00,549 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 15:31:00,550 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 15:31:00,550 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 15:31:00,730 - __main__ - INFO - 
2025-12-09 15:31:00,730 - __main__ - INFO - [API] Response Status: 200
2025-12-09 15:31:00,732 - __main__ - INFO - 
2025-12-09 15:31:00,732 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 5406 chars)
2025-12-09 15:31:00,733 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'pmReportFormRTU', 'pmMainRtuCabinet', 'pmChamberMagneticContact', 'pmrtuCabinetCooling', 'pmdvrEquipment', 'pmMainRtuCabinetImages', 'pmChamberMagneticContactImages', 'pmrtuCabinetCoolingImages', 'pmdvrEquipmentImages']
2025-12-09 15:31:00,736 - __main__ - INFO - 
2025-12-09 15:31:00,737 - __main__ - INFO - [STEP 6] Transforming API data for report type rtu_pm_reportform_pdf...
2025-12-09 15:31:00,738 - __main__ - INFO - 
2025-12-09 15:31:00,738 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 15:31:00,739 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 15:31:00,801 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a2691f20-d26a-4e6c-b3e7-f85e060aec4b\Signatures\20251209_153100_6732832d5d3740caaba652d6e676a1f3.png
2025-12-09 15:31:00,802 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\a2691f20-d26a-4e6c-b3e7-f85e060aec4b\Signatures\20251209_153100_89687eb0d7aa40ccb260149fbb12e057.png
2025-12-09 15:31:00,803 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 15:31:00,804 - __main__ - INFO - 
2025-12-09 15:31:00,804 - __main__ - INFO - [STEP 7] Using job number: 10010006
2025-12-09 15:31:00,804 - __main__ - INFO - 
2025-12-09 15:31:00,805 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 15:31:00,841 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Adding signature images to final summary page
2025-12-09 15:31:01,518 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Generated RTU PM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010006_20251209_153100.pdf
2025-12-09 15:31:01,519 - __main__ - INFO - 
2025-12-09 15:31:01,520 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010006_20251209_153100.pdf
2025-12-09 15:31:01,520 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 15:31:01,521 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "a2691f20-d26a-4e6c-b3e7-f85e060aec4b",
  "status": "completed",
  "message": "PDF generated successfully: RTU_PM_FinalReport_Report_10010006_20251209_153100.pdf",
  "timestamp": "2025-12-09T15:31:01.520786",
  "file_name": "RTU_PM_FinalReport_Report_10010006_20251209_153100.pdf"
}
2025-12-09 15:31:01,522 - __main__ - INFO - [STATUS UPDATE] a2691f20-d26a-4e6c-b3e7-f85e060aec4b -> COMPLETED - PDF generated successfully: RTU_PM_FinalReport_Report_10010006_20251209_153100.pdf
2025-12-09 15:31:01,522 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=14
2025-12-09 15:31:01,523 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/a2691f20-d26a-4e6c-b3e7-f85e060aec4b
2025-12-09 17:36:34,845 - __main__ - INFO - 
2025-12-09 17:36:34,846 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-09 17:36:34,846 - __main__ - INFO - [DATA] Message data: {'report_id': '98218959-a7dd-4e90-9c7f-e758b61e22c7', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-09T09:36:34.8336135Z', 'report_type': 'rtu_pm_final_report'}
2025-12-09 17:36:34,852 - __main__ - INFO - 
2025-12-09 17:36:34,853 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 98218959-a7dd-4e90-9c7f-e758b61e22c7 (rtu_pm_reportform_signature_pdf)
2025-12-09 17:36:34,853 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-09 17:36:34,855 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-09 17:36:34,858 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "98218959-a7dd-4e90-9c7f-e758b61e22c7",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-09T17:36:34.855174"
}
2025-12-09 17:36:34,862 - __main__ - INFO - [STATUS UPDATE] 98218959-a7dd-4e90-9c7f-e758b61e22c7 -> PROCESSING - PDF generation started
2025-12-09 17:36:34,865 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=15
2025-12-09 17:36:34,867 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-09 17:36:34,868 - __main__ - INFO - 
2025-12-09 17:36:34,870 - __main__ - INFO - [STEP 5] Calling API endpoint /api/ReportForm/RTUPMReportForm/98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-09 17:36:34,875 - __main__ - INFO - 
2025-12-09 17:36:34,877 - __main__ - INFO - [API] URL: https://localhost:7145/api/ReportForm/RTUPMReportForm/98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-09 17:36:35,027 - __main__ - INFO - 
2025-12-09 17:36:35,028 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-09 17:36:35,028 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-09 17:36:35,028 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-09 17:36:35,185 - __main__ - INFO - 
2025-12-09 17:36:35,185 - __main__ - INFO - [API] Response Status: 200
2025-12-09 17:36:35,186 - __main__ - INFO - 
2025-12-09 17:36:35,187 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 6362 chars)
2025-12-09 17:36:35,188 - __main__ - INFO - [API] Response Keys: ['id', 'reportFormTypeID', 'reportFormTypeName', 'jobNo', 'systemNameWarehouseID', 'systemNameWarehouseName', 'stationNameWarehouseID', 'stationNameWarehouseName', 'uploadStatus', 'uploadHostname', 'uploadIPAddress', 'formStatus', 'createdDate', 'updatedDate', 'createdBy', 'createdByUserName', 'updatedBy', 'updatedByUserName', 'pmReportFormRTU', 'pmMainRtuCabinet', 'pmChamberMagneticContact', 'pmrtuCabinetCooling', 'pmdvrEquipment', 'pmMainRtuCabinetImages', 'pmChamberMagneticContactImages', 'pmrtuCabinetCoolingImages', 'pmdvrEquipmentImages']
2025-12-09 17:36:35,191 - __main__ - INFO - 
2025-12-09 17:36:35,191 - __main__ - INFO - [STEP 6] Transforming API data for report type rtu_pm_reportform_pdf...
2025-12-09 17:36:35,192 - __main__ - INFO - 
2025-12-09 17:36:35,192 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-09 17:36:35,193 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-09 17:36:35,264 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\98218959-a7dd-4e90-9c7f-e758b61e22c7\Signatures\20251209_173634_a14071b9191041d2876bf465e3dab300.png
2025-12-09 17:36:35,265 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\98218959-a7dd-4e90-9c7f-e758b61e22c7\Signatures\20251209_173634_13331b756e7b46edba01326677e30ab6.png
2025-12-09 17:36:35,267 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-09 17:36:35,268 - __main__ - INFO - 
2025-12-09 17:36:35,269 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-09 17:36:35,269 - __main__ - INFO - 
2025-12-09 17:36:35,270 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-09 17:36:35,294 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Adding signature images to final summary page
2025-12-09 17:36:36,269 - RTU_PM_Report.rtu_pdf_generator - INFO - [RTU PDF] Generated RTU PM report at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010001_20251209_173635.pdf
2025-12-09 17:36:36,271 - __main__ - INFO - 
2025-12-09 17:36:36,271 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\RTU_PM_FinalReport_Report_10010001_20251209_173635.pdf
2025-12-09 17:36:36,272 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/rtu_pm_reportform_signature_pdf_status/98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-09 17:36:36,273 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "98218959-a7dd-4e90-9c7f-e758b61e22c7",
  "status": "completed",
  "message": "PDF generated successfully: RTU_PM_FinalReport_Report_10010001_20251209_173635.pdf",
  "timestamp": "2025-12-09T17:36:36.272416",
  "file_name": "RTU_PM_FinalReport_Report_10010001_20251209_173635.pdf"
}
2025-12-09 17:36:36,275 - __main__ - INFO - [STATUS UPDATE] 98218959-a7dd-4e90-9c7f-e758b61e22c7 -> COMPLETED - PDF generated successfully: RTU_PM_FinalReport_Report_10010001_20251209_173635.pdf
2025-12-09 17:36:36,276 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=16
2025-12-09 17:36:36,277 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/rtu_pm_reportform_signature_pdf_status/98218959-a7dd-4e90-9c7f-e758b61e22c7
2025-12-26 09:40:22,295 - __main__ - INFO - 
2025-12-26 09:40:22,296 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 09:40:22,301 - __main__ - INFO - 
2025-12-26 09:40:22,301 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 09:40:22,304 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 09:40:22,304 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 09:40:22,305 - __main__ - INFO - Authenticating with API...
2025-12-26 09:40:22,305 - __main__ - INFO - 
2025-12-26 09:40:22,305 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 09:40:22,344 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 09:40:22,344 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 09:40:25,356 - __main__ - INFO - 
2025-12-26 09:40:25,356 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 09:40:25,356 - __main__ - INFO - 
2025-12-26 09:40:25,356 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 09:40:25,357 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T01:40:25.3514252Z
2025-12-26 09:40:25,393 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 09:40:25,427 - __main__ - INFO - 
2025-12-26 09:40:25,428 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 09:40:25,428 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 09:40:25,825 - __main__ - INFO - 
2025-12-26 09:40:25,825 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 09:40:25,826 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 09:40:25,827 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 09:40:25,828 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 09:40:25,828 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 09:40:25,829 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 09:40:25,830 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 09:49:26,684 - __main__ - INFO - 
2025-12-26 09:49:26,685 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 09:49:26,686 - __main__ - INFO - 
2025-12-26 09:49:26,686 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 09:49:26,687 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 09:49:26,687 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 09:49:26,687 - __main__ - INFO - Authenticating with API...
2025-12-26 09:49:26,687 - __main__ - INFO - 
2025-12-26 09:49:26,687 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 09:49:26,713 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 09:49:26,714 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 09:49:27,269 - __main__ - INFO - 
2025-12-26 09:49:27,269 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 09:49:27,270 - __main__ - INFO - 
2025-12-26 09:49:27,270 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 09:49:27,271 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T01:49:27.2679327Z
2025-12-26 09:49:27,272 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 09:49:27,281 - __main__ - INFO - 
2025-12-26 09:49:27,281 - __main__ - INFO - 
2025-12-26 09:49:27,282 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 09:49:27,282 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 09:49:27,282 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 09:49:27,283 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 09:49:27,284 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 09:49:27,284 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 09:49:27,285 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 09:49:27,286 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 09:49:27,286 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 10:25:09,843 - __main__ - INFO - 
2025-12-26 10:25:09,845 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:25:09,845 - __main__ - INFO - [DATA] Message data: {'report_id': '979e21e6-3715-4cbc-abf5-265692314487', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T02:25:09.8285003Z', 'report_type': 'server_pm_final_report'}
2025-12-26 10:25:09,853 - __main__ - INFO - 
2025-12-26 10:25:09,854 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 979e21e6-3715-4cbc-abf5-265692314487 (server_pm_reportform_signature_pdf)
2025-12-26 10:25:09,854 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 10:25:09,855 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:25:09,855 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "979e21e6-3715-4cbc-abf5-265692314487",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T10:25:09.855172"
}
2025-12-26 10:25:09,856 - __main__ - INFO - [STATUS UPDATE] 979e21e6-3715-4cbc-abf5-265692314487 -> PROCESSING - PDF generation started
2025-12-26 10:25:09,857 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 10:25:09,857 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:25:09,858 - __main__ - INFO - 
2025-12-26 10:25:09,859 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 10:25:09,860 - __main__ - INFO - 
2025-12-26 10:25:09,860 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 10:25:09,862 - __main__ - INFO - 
2025-12-26 10:25:09,862 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:25:09,863 - __main__ - INFO - 
2025-12-26 10:25:09,864 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:25:09,936 - __main__ - INFO - 
2025-12-26 10:25:09,937 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 10:25:09,937 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 10:25:09,937 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 10:25:10,744 - __main__ - INFO - 
2025-12-26 10:25:10,745 - __main__ - INFO - [API] Response Status: 200
2025-12-26 10:25:10,747 - __main__ - INFO - 
2025-12-26 10:25:10,749 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3931 chars)
2025-12-26 10:25:10,749 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 10:25:10,752 - __main__ - INFO - 
2025-12-26 10:25:10,752 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 10:25:10,753 - __main__ - INFO - 
2025-12-26 10:25:10,753 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 10:25:10,754 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 10:25:11,073 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\979e21e6-3715-4cbc-abf5-265692314487\Signatures\20251226_102509_89ef6f08d1ab4970bb47fd248ebdf403.png
2025-12-26 10:25:11,073 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\979e21e6-3715-4cbc-abf5-265692314487\Signatures\20251226_102509_b4ef88bb927142d59cb3a5dee849219a.png
2025-12-26 10:25:11,076 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 10:25:11,076 - __main__ - INFO - 
2025-12-26 10:25:11,077 - __main__ - INFO - [STEP 7] Using job number: 10010003
2025-12-26 10:25:11,077 - __main__ - INFO - 
2025-12-26 10:25:11,077 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 10:25:11,078 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 10:25:11,079 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 10:25:11,080 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 10:25:11,116 - Server_PM_Report.server_pm_pdf_generator - ERROR - Error generating PDF: name 'has_signatures' is not defined
2025-12-26 10:25:11,117 - __main__ - ERROR - [STEP 8 FAILED] PDF generation failed
2025-12-26 10:25:11,118 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:25:11,118 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "979e21e6-3715-4cbc-abf5-265692314487",
  "status": "failed",
  "message": "PDF generation failed",
  "timestamp": "2025-12-26T10:25:11.118122"
}
2025-12-26 10:25:11,119 - __main__ - INFO - [STATUS UPDATE] 979e21e6-3715-4cbc-abf5-265692314487 -> FAILED - PDF generation failed
2025-12-26 10:25:11,119 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 10:25:11,119 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/979e21e6-3715-4cbc-abf5-265692314487
2025-12-26 10:29:46,270 - __main__ - INFO - 
2025-12-26 10:29:46,271 - __main__ - INFO - Cleaning up resources...
2025-12-26 10:29:46,323 - __main__ - INFO - MQTT client disconnected
2025-12-26 10:29:46,324 - __main__ - INFO - 
2025-12-26 10:29:46,324 - __main__ - INFO - Cleanup completed
2025-12-26 10:29:50,507 - __main__ - INFO - 
2025-12-26 10:29:50,508 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 10:29:50,509 - __main__ - INFO - 
2025-12-26 10:29:50,510 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 10:29:50,510 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 10:29:50,511 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 10:29:50,511 - __main__ - INFO - Authenticating with API...
2025-12-26 10:29:50,511 - __main__ - INFO - 
2025-12-26 10:29:50,511 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 10:29:50,540 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 10:29:50,541 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 10:29:50,975 - __main__ - INFO - 
2025-12-26 10:29:50,975 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 10:29:50,976 - __main__ - INFO - 
2025-12-26 10:29:50,976 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 10:29:50,976 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T02:29:50.9731177Z
2025-12-26 10:29:50,977 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 10:29:50,982 - __main__ - INFO - 
2025-12-26 10:29:50,983 - __main__ - INFO - 
2025-12-26 10:29:50,983 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 10:29:50,984 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 10:29:50,984 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 10:29:50,986 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 10:29:50,988 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 10:29:50,989 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 10:29:50,989 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 10:29:50,990 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 10:29:50,991 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 10:30:47,625 - __main__ - INFO - 
2025-12-26 10:30:47,626 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:30:47,626 - __main__ - INFO - [DATA] Message data: {'report_id': '062c3de4-ed0b-47ba-bcf4-9450f152a6d1', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T02:30:47.6174738Z', 'report_type': 'server_pm_final_report'}
2025-12-26 10:30:47,630 - __main__ - INFO - 
2025-12-26 10:30:47,630 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 062c3de4-ed0b-47ba-bcf4-9450f152a6d1 (server_pm_reportform_signature_pdf)
2025-12-26 10:30:47,631 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 10:30:47,631 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:30:47,632 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "062c3de4-ed0b-47ba-bcf4-9450f152a6d1",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T10:30:47.631922"
}
2025-12-26 10:30:47,634 - __main__ - INFO - [STATUS UPDATE] 062c3de4-ed0b-47ba-bcf4-9450f152a6d1 -> PROCESSING - PDF generation started
2025-12-26 10:30:47,637 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 10:30:47,638 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:30:47,638 - __main__ - INFO - 
2025-12-26 10:30:47,639 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 10:30:47,640 - __main__ - INFO - 
2025-12-26 10:30:47,640 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 10:30:47,642 - __main__ - INFO - 
2025-12-26 10:30:47,643 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:30:47,644 - __main__ - INFO - 
2025-12-26 10:30:47,644 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:30:47,760 - __main__ - INFO - 
2025-12-26 10:30:47,760 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 10:30:47,761 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 10:30:47,761 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 10:30:48,581 - __main__ - INFO - 
2025-12-26 10:30:48,582 - __main__ - INFO - [API] Response Status: 200
2025-12-26 10:30:48,583 - __main__ - INFO - 
2025-12-26 10:30:48,584 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3946 chars)
2025-12-26 10:30:48,584 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 10:30:48,587 - __main__ - INFO - 
2025-12-26 10:30:48,588 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 10:30:48,589 - __main__ - INFO - 
2025-12-26 10:30:48,589 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 10:30:48,590 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 10:30:48,847 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\062c3de4-ed0b-47ba-bcf4-9450f152a6d1\Signatures\20251226_103047_1b3c494c844a4cccac9c66b29362a159.png
2025-12-26 10:30:48,848 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\062c3de4-ed0b-47ba-bcf4-9450f152a6d1\Signatures\20251226_103047_e5c12a1bb87544cbba8c39301ae07b5a.png
2025-12-26 10:30:48,849 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 10:30:48,850 - __main__ - INFO - 
2025-12-26 10:30:48,851 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-26 10:30:48,852 - __main__ - INFO - 
2025-12-26 10:30:48,852 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 10:30:48,853 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 10:30:48,854 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 10:30:48,856 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 10:30:48,880 - Server_PM_Report.server_pm_pdf_generator - ERROR - Error generating PDF: name 'has_signatures' is not defined
2025-12-26 10:30:48,881 - __main__ - ERROR - [STEP 8 FAILED] PDF generation failed
2025-12-26 10:30:48,884 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:30:48,894 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "062c3de4-ed0b-47ba-bcf4-9450f152a6d1",
  "status": "failed",
  "message": "PDF generation failed",
  "timestamp": "2025-12-26T10:30:48.884591"
}
2025-12-26 10:30:48,897 - __main__ - INFO - [STATUS UPDATE] 062c3de4-ed0b-47ba-bcf4-9450f152a6d1 -> FAILED - PDF generation failed
2025-12-26 10:30:48,903 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 10:30:48,907 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/062c3de4-ed0b-47ba-bcf4-9450f152a6d1
2025-12-26 10:31:47,946 - __main__ - INFO - 
2025-12-26 10:31:47,946 - __main__ - INFO - Cleaning up resources...
2025-12-26 10:32:17,136 - __main__ - INFO - 
2025-12-26 10:32:17,136 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 10:32:17,137 - __main__ - INFO - 
2025-12-26 10:32:17,138 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 10:32:17,138 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 10:32:17,138 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 10:32:17,138 - __main__ - INFO - Authenticating with API...
2025-12-26 10:32:17,138 - __main__ - INFO - 
2025-12-26 10:32:17,139 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 10:32:17,173 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 10:32:17,174 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 10:32:17,597 - __main__ - INFO - 
2025-12-26 10:32:17,598 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 10:32:17,599 - __main__ - INFO - 
2025-12-26 10:32:17,599 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 10:32:17,599 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T02:32:17.5960651Z
2025-12-26 10:32:17,600 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 10:32:17,605 - __main__ - INFO - 
2025-12-26 10:32:17,605 - __main__ - INFO - 
2025-12-26 10:32:17,605 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 10:32:17,606 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 10:32:17,607 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 10:32:17,607 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 10:32:17,608 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 10:32:17,609 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 10:32:17,609 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 10:32:17,610 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 10:32:17,611 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 10:33:18,574 - __main__ - INFO - 
2025-12-26 10:33:18,574 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:33:18,575 - __main__ - INFO - [DATA] Message data: {'report_id': '554f77df-0e66-4f70-b350-ad9ec39b8458', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T02:33:18.5673623Z', 'report_type': 'server_pm_final_report'}
2025-12-26 10:33:18,581 - __main__ - INFO - 
2025-12-26 10:33:18,582 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 554f77df-0e66-4f70-b350-ad9ec39b8458 (server_pm_reportform_signature_pdf)
2025-12-26 10:33:18,583 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 10:33:18,584 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:33:18,585 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "554f77df-0e66-4f70-b350-ad9ec39b8458",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T10:33:18.583890"
}
2025-12-26 10:33:18,586 - __main__ - INFO - [STATUS UPDATE] 554f77df-0e66-4f70-b350-ad9ec39b8458 -> PROCESSING - PDF generation started
2025-12-26 10:33:18,587 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 10:33:18,588 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:33:18,589 - __main__ - INFO - 
2025-12-26 10:33:18,590 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 10:33:18,592 - __main__ - INFO - 
2025-12-26 10:33:18,593 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 10:33:18,597 - __main__ - INFO - 
2025-12-26 10:33:18,598 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:33:18,599 - __main__ - INFO - 
2025-12-26 10:33:18,600 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:33:18,712 - __main__ - INFO - 
2025-12-26 10:33:18,713 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 10:33:18,713 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 10:33:18,714 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 10:33:19,475 - __main__ - INFO - 
2025-12-26 10:33:19,477 - __main__ - INFO - [API] Response Status: 200
2025-12-26 10:33:19,479 - __main__ - INFO - 
2025-12-26 10:33:19,481 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3453 chars)
2025-12-26 10:33:19,481 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 10:33:19,487 - __main__ - INFO - 
2025-12-26 10:33:19,489 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 10:33:19,491 - __main__ - INFO - 
2025-12-26 10:33:19,495 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 10:33:19,499 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 10:33:19,722 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\554f77df-0e66-4f70-b350-ad9ec39b8458\Signatures\20251226_103318_36ee8364f05c4bff8dc483d37c22039a.png
2025-12-26 10:33:19,723 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\554f77df-0e66-4f70-b350-ad9ec39b8458\Signatures\20251226_103318_a122886a0b1d4955bde1d5a27358b047.png
2025-12-26 10:33:19,724 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 10:33:19,724 - __main__ - INFO - 
2025-12-26 10:33:19,725 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-26 10:33:19,725 - __main__ - INFO - 
2025-12-26 10:33:19,727 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 10:33:19,727 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 10:33:19,728 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 10:33:19,729 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 10:33:19,743 - Server_PM_Report.server_pm_pdf_generator - ERROR - Error generating PDF: name 'has_signatures' is not defined
2025-12-26 10:33:19,745 - __main__ - ERROR - [STEP 8 FAILED] PDF generation failed
2025-12-26 10:33:19,746 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:33:19,747 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "554f77df-0e66-4f70-b350-ad9ec39b8458",
  "status": "failed",
  "message": "PDF generation failed",
  "timestamp": "2025-12-26T10:33:19.746245"
}
2025-12-26 10:33:19,749 - __main__ - INFO - [STATUS UPDATE] 554f77df-0e66-4f70-b350-ad9ec39b8458 -> FAILED - PDF generation failed
2025-12-26 10:33:19,750 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 10:33:19,751 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/554f77df-0e66-4f70-b350-ad9ec39b8458
2025-12-26 10:36:31,960 - __main__ - INFO - 
2025-12-26 10:36:31,961 - __main__ - INFO - Cleaning up resources...
2025-12-26 10:36:36,942 - __main__ - INFO - 
2025-12-26 10:36:36,943 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 10:36:36,944 - __main__ - INFO - 
2025-12-26 10:36:36,944 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 10:36:36,944 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 10:36:36,944 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 10:36:36,944 - __main__ - INFO - Authenticating with API...
2025-12-26 10:36:36,945 - __main__ - INFO - 
2025-12-26 10:36:36,945 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 10:36:36,970 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 10:36:36,971 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 10:36:37,350 - __main__ - INFO - 
2025-12-26 10:36:37,350 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 10:36:37,351 - __main__ - INFO - 
2025-12-26 10:36:37,352 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 10:36:37,352 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T02:36:37.3488104Z
2025-12-26 10:36:37,354 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 10:36:37,384 - __main__ - INFO - 
2025-12-26 10:36:37,386 - __main__ - INFO - 
2025-12-26 10:36:37,386 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 10:36:37,387 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 10:36:37,388 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 10:36:37,391 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 10:36:37,393 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 10:36:37,394 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 10:36:37,396 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 10:36:37,398 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 10:36:37,400 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 11:59:50,387 - __main__ - INFO - 
2025-12-26 11:59:50,388 - __main__ - INFO - Cleaning up resources...
2025-12-26 11:59:54,719 - __main__ - INFO - 
2025-12-26 11:59:54,719 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 11:59:54,721 - __main__ - INFO - 
2025-12-26 11:59:54,721 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 11:59:54,721 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 11:59:54,721 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 11:59:54,721 - __main__ - INFO - Authenticating with API...
2025-12-26 11:59:54,721 - __main__ - INFO - 
2025-12-26 11:59:54,722 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 11:59:54,756 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 11:59:54,756 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 11:59:55,205 - __main__ - INFO - 
2025-12-26 11:59:55,205 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 11:59:55,206 - __main__ - INFO - 
2025-12-26 11:59:55,206 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 11:59:55,206 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T03:59:55.2041042Z
2025-12-26 11:59:55,208 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 11:59:55,213 - __main__ - INFO - 
2025-12-26 11:59:55,213 - __main__ - INFO - 
2025-12-26 11:59:55,213 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 11:59:55,214 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 11:59:55,214 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 11:59:55,215 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 11:59:55,215 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 11:59:55,216 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 11:59:55,217 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 11:59:55,217 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 11:59:55,217 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 12:00:46,090 - __main__ - INFO - 
2025-12-26 12:00:46,091 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:00:46,091 - __main__ - INFO - [DATA] Message data: {'report_id': 'e9f8d7bc-fc7f-4e64-854a-b5953a6babca', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T04:00:46.0820498Z', 'report_type': 'server_pm_final_report'}
2025-12-26 12:00:46,095 - __main__ - INFO - 
2025-12-26 12:00:46,096 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: e9f8d7bc-fc7f-4e64-854a-b5953a6babca (server_pm_reportform_signature_pdf)
2025-12-26 12:00:46,096 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 12:00:46,097 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:00:46,097 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "e9f8d7bc-fc7f-4e64-854a-b5953a6babca",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T12:00:46.097013"
}
2025-12-26 12:00:46,099 - __main__ - INFO - [STATUS UPDATE] e9f8d7bc-fc7f-4e64-854a-b5953a6babca -> PROCESSING - PDF generation started
2025-12-26 12:00:46,099 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 12:00:46,102 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:00:46,105 - __main__ - INFO - 
2025-12-26 12:00:46,106 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 12:00:46,106 - __main__ - INFO - 
2025-12-26 12:00:46,107 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 12:00:46,109 - __main__ - INFO - 
2025-12-26 12:00:46,109 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:00:46,110 - __main__ - INFO - 
2025-12-26 12:00:46,111 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:00:46,242 - __main__ - INFO - 
2025-12-26 12:00:46,243 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 12:00:46,243 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 12:00:46,243 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 12:00:47,037 - __main__ - INFO - 
2025-12-26 12:00:47,037 - __main__ - INFO - [API] Response Status: 200
2025-12-26 12:00:47,038 - __main__ - INFO - 
2025-12-26 12:00:47,039 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 2579 chars)
2025-12-26 12:00:47,040 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 12:00:47,042 - __main__ - INFO - 
2025-12-26 12:00:47,043 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 12:00:47,044 - __main__ - INFO - 
2025-12-26 12:00:47,044 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 12:00:47,045 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 12:00:47,272 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\e9f8d7bc-fc7f-4e64-854a-b5953a6babca\Signatures\20251226_120045_e6d4850e4d05404fa3341dc615fbd90e.png
2025-12-26 12:00:47,273 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\e9f8d7bc-fc7f-4e64-854a-b5953a6babca\Signatures\20251226_120045_ca09483b7880490aa78459063492b376.png
2025-12-26 12:00:47,276 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 12:00:47,277 - __main__ - INFO - 
2025-12-26 12:00:47,277 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-26 12:00:47,278 - __main__ - INFO - 
2025-12-26 12:00:47,279 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 12:00:47,280 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 12:00:47,281 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 12:00:47,281 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 12:00:47,692 - Server_PM_Report.server_pm_pdf_generator - INFO - PDF generated successfully: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010001_20251226_120047.pdf
2025-12-26 12:00:47,692 - __main__ - INFO - 
2025-12-26 12:00:47,693 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010001_20251226_120047.pdf
2025-12-26 12:00:47,694 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:00:47,695 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "e9f8d7bc-fc7f-4e64-854a-b5953a6babca",
  "status": "completed",
  "message": "PDF generated successfully: Server_PM_FinalReport_Report_10010001_20251226_120047.pdf",
  "timestamp": "2025-12-26T12:00:47.694578",
  "file_name": "Server_PM_FinalReport_Report_10010001_20251226_120047.pdf"
}
2025-12-26 12:00:47,697 - __main__ - INFO - [STATUS UPDATE] e9f8d7bc-fc7f-4e64-854a-b5953a6babca -> COMPLETED - PDF generated successfully: Server_PM_FinalReport_Report_10010001_20251226_120047.pdf
2025-12-26 12:00:47,700 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 12:00:47,702 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/e9f8d7bc-fc7f-4e64-854a-b5953a6babca
2025-12-26 12:03:15,350 - __main__ - INFO - 
2025-12-26 12:03:15,351 - __main__ - INFO - Cleaning up resources...
2025-12-26 12:03:19,423 - __main__ - INFO - 
2025-12-26 12:03:19,424 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 12:03:19,427 - __main__ - INFO - 
2025-12-26 12:03:19,428 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 12:03:19,429 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 12:03:19,429 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 12:03:19,430 - __main__ - INFO - Authenticating with API...
2025-12-26 12:03:19,430 - __main__ - INFO - 
2025-12-26 12:03:19,430 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 12:03:19,515 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 12:03:19,515 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 12:03:19,846 - __main__ - INFO - 
2025-12-26 12:03:19,846 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 12:03:19,847 - __main__ - INFO - 
2025-12-26 12:03:19,847 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 12:03:19,847 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T04:03:19.8429273Z
2025-12-26 12:03:19,849 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 12:03:19,852 - __main__ - INFO - 
2025-12-26 12:03:19,852 - __main__ - INFO - 
2025-12-26 12:03:19,852 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 12:03:19,852 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 12:03:19,853 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 12:03:19,853 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 12:03:19,854 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 12:03:19,854 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 12:03:19,855 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 12:03:19,855 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 12:03:19,856 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 12:05:12,860 - __main__ - INFO - 
2025-12-26 12:05:12,861 - __main__ - INFO - Cleaning up resources...
2025-12-26 12:05:41,386 - __main__ - INFO - 
2025-12-26 12:05:41,386 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 12:05:41,387 - __main__ - INFO - 
2025-12-26 12:05:41,387 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 12:05:41,388 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 12:05:41,388 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 12:05:41,388 - __main__ - INFO - Authenticating with API...
2025-12-26 12:05:41,389 - __main__ - INFO - 
2025-12-26 12:05:41,389 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 12:05:41,413 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 12:05:41,414 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 12:05:41,808 - __main__ - INFO - 
2025-12-26 12:05:41,809 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 12:05:41,810 - __main__ - INFO - 
2025-12-26 12:05:41,810 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 12:05:41,810 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T04:05:41.807871Z
2025-12-26 12:05:41,813 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 12:05:41,818 - __main__ - INFO - 
2025-12-26 12:05:41,818 - __main__ - INFO - 
2025-12-26 12:05:41,819 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 12:05:41,819 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 12:05:41,820 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 12:05:41,820 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 12:05:41,821 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 12:05:41,821 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 12:05:41,822 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 12:05:41,822 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 12:05:41,823 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 12:06:46,750 - __main__ - INFO - 
2025-12-26 12:06:46,751 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:06:46,751 - __main__ - INFO - [DATA] Message data: {'report_id': 'c3753949-c74b-42bb-af9f-dc364008fa59', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T04:06:46.7446182Z', 'report_type': 'server_pm_final_report'}
2025-12-26 12:06:46,756 - __main__ - INFO - 
2025-12-26 12:06:46,756 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: c3753949-c74b-42bb-af9f-dc364008fa59 (server_pm_reportform_signature_pdf)
2025-12-26 12:06:46,757 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 12:06:46,758 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:06:46,758 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "c3753949-c74b-42bb-af9f-dc364008fa59",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T12:06:46.757950"
}
2025-12-26 12:06:46,760 - __main__ - INFO - [STATUS UPDATE] c3753949-c74b-42bb-af9f-dc364008fa59 -> PROCESSING - PDF generation started
2025-12-26 12:06:46,760 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 12:06:46,761 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:06:46,761 - __main__ - INFO - 
2025-12-26 12:06:46,761 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 12:06:46,762 - __main__ - INFO - 
2025-12-26 12:06:46,762 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 12:06:46,763 - __main__ - INFO - 
2025-12-26 12:06:46,764 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:06:46,764 - __main__ - INFO - 
2025-12-26 12:06:46,765 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:06:46,882 - __main__ - INFO - 
2025-12-26 12:06:46,883 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 12:06:46,883 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 12:06:46,885 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 12:06:47,728 - __main__ - INFO - 
2025-12-26 12:06:47,729 - __main__ - INFO - [API] Response Status: 200
2025-12-26 12:06:47,730 - __main__ - INFO - 
2025-12-26 12:06:47,731 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3433 chars)
2025-12-26 12:06:47,731 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 12:06:47,734 - __main__ - INFO - 
2025-12-26 12:06:47,734 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 12:06:47,735 - __main__ - INFO - 
2025-12-26 12:06:47,736 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 12:06:47,736 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 12:06:48,001 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\c3753949-c74b-42bb-af9f-dc364008fa59\Signatures\20251226_120646_e07500dbd498481db62442a69c671502.png
2025-12-26 12:06:48,001 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\c3753949-c74b-42bb-af9f-dc364008fa59\Signatures\20251226_120646_ce2fa15111164bc6b3c5856aecaa0a5e.png
2025-12-26 12:06:48,003 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 12:06:48,004 - __main__ - INFO - 
2025-12-26 12:06:48,005 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-26 12:06:48,005 - __main__ - INFO - 
2025-12-26 12:06:48,006 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 12:06:48,006 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 12:06:48,007 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 12:06:48,008 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 12:06:48,013 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature detection - has_signatures: True
2025-12-26 12:06:48,014 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature images type: <class 'dict'>, length: 2
2025-12-26 12:06:48,014 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-26 12:06:48,209 - Server_PM_Report.server_pm_pdf_generator - INFO - PDF generated successfully: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010002_20251226_120648.pdf
2025-12-26 12:06:48,210 - __main__ - INFO - 
2025-12-26 12:06:48,210 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010002_20251226_120648.pdf
2025-12-26 12:06:48,210 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:06:48,211 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "c3753949-c74b-42bb-af9f-dc364008fa59",
  "status": "completed",
  "message": "PDF generated successfully: Server_PM_FinalReport_Report_10010002_20251226_120648.pdf",
  "timestamp": "2025-12-26T12:06:48.210873",
  "file_name": "Server_PM_FinalReport_Report_10010002_20251226_120648.pdf"
}
2025-12-26 12:06:48,211 - __main__ - INFO - [STATUS UPDATE] c3753949-c74b-42bb-af9f-dc364008fa59 -> COMPLETED - PDF generated successfully: Server_PM_FinalReport_Report_10010002_20251226_120648.pdf
2025-12-26 12:06:48,212 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 12:06:48,213 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/c3753949-c74b-42bb-af9f-dc364008fa59
2025-12-26 12:09:16,218 - __main__ - INFO - 
2025-12-26 12:09:16,218 - __main__ - INFO - Cleaning up resources...
2025-12-26 12:09:16,319 - __main__ - INFO - MQTT client disconnected
2025-12-26 12:09:16,320 - __main__ - INFO - 
2025-12-26 12:09:16,320 - __main__ - INFO - Cleanup completed
2025-12-26 12:09:34,849 - __main__ - INFO - 
2025-12-26 12:09:34,850 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 12:09:34,852 - __main__ - INFO - 
2025-12-26 12:09:34,852 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 12:09:34,853 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 12:09:34,853 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 12:09:34,853 - __main__ - INFO - Authenticating with API...
2025-12-26 12:09:34,853 - __main__ - INFO - 
2025-12-26 12:09:34,853 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 12:09:34,891 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 12:09:34,892 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 12:09:35,314 - __main__ - INFO - 
2025-12-26 12:09:35,314 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 12:09:35,315 - __main__ - INFO - 
2025-12-26 12:09:35,315 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 12:09:35,316 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T04:09:35.3132064Z
2025-12-26 12:09:35,317 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 12:09:35,322 - __main__ - INFO - 
2025-12-26 12:09:35,323 - __main__ - INFO - 
2025-12-26 12:09:35,323 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 12:09:35,323 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 12:09:35,324 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 12:09:35,325 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 12:09:35,325 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 12:09:35,326 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 12:09:35,326 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 12:09:35,327 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 12:09:35,327 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 12:11:13,094 - __main__ - INFO - 
2025-12-26 12:11:13,095 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:11:13,095 - __main__ - INFO - [DATA] Message data: {'report_id': 'ddf21461-7230-48dd-843e-9a71ee55ef3f', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T04:11:13.0882069Z', 'report_type': 'server_pm_final_report'}
2025-12-26 12:11:13,099 - __main__ - INFO - 
2025-12-26 12:11:13,100 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: ddf21461-7230-48dd-843e-9a71ee55ef3f (server_pm_reportform_signature_pdf)
2025-12-26 12:11:13,100 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 12:11:13,101 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:11:13,101 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "ddf21461-7230-48dd-843e-9a71ee55ef3f",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T12:11:13.100978"
}
2025-12-26 12:11:13,102 - __main__ - INFO - [STATUS UPDATE] ddf21461-7230-48dd-843e-9a71ee55ef3f -> PROCESSING - PDF generation started
2025-12-26 12:11:13,103 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 12:11:13,104 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:11:13,104 - __main__ - INFO - 
2025-12-26 12:11:13,105 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 12:11:13,105 - __main__ - INFO - 
2025-12-26 12:11:13,106 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 12:11:13,109 - __main__ - INFO - 
2025-12-26 12:11:13,110 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:11:13,111 - __main__ - INFO - 
2025-12-26 12:11:13,111 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:11:13,219 - __main__ - INFO - 
2025-12-26 12:11:13,220 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 12:11:13,220 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 12:11:13,221 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 12:11:14,041 - __main__ - INFO - 
2025-12-26 12:11:14,041 - __main__ - INFO - [API] Response Status: 200
2025-12-26 12:11:14,042 - __main__ - INFO - 
2025-12-26 12:11:14,043 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3444 chars)
2025-12-26 12:11:14,043 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 12:11:14,046 - __main__ - INFO - 
2025-12-26 12:11:14,047 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 12:11:14,048 - __main__ - INFO - 
2025-12-26 12:11:14,049 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 12:11:14,049 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 12:11:14,300 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\ddf21461-7230-48dd-843e-9a71ee55ef3f\Signatures\20251226_121112_16b4d51b039341648d8ea45f5948fe20.png
2025-12-26 12:11:14,300 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\ddf21461-7230-48dd-843e-9a71ee55ef3f\Signatures\20251226_121112_7c073d5230c645998789949e8fe07939.png
2025-12-26 12:11:14,302 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 12:11:14,303 - __main__ - INFO - 
2025-12-26 12:11:14,303 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-26 12:11:14,304 - __main__ - INFO - 
2025-12-26 12:11:14,304 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 12:11:14,305 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 12:11:14,305 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 12:11:14,307 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 12:11:14,311 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature detection - has_signatures: True
2025-12-26 12:11:14,312 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature images type: <class 'dict'>, length: 2
2025-12-26 12:11:14,312 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-26 12:11:14,313 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image values: ['C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\ddf21461-7230-48dd-843e-9a71ee55ef3f\\Signatures\\20251226_121112_16b4d51b039341648d8ea45f5948fe20.png', 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\ddf21461-7230-48dd-843e-9a71ee55ef3f\\Signatures\\20251226_121112_7c073d5230c645998789949e8fe07939.png']
2025-12-26 12:11:14,313 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Calling _create_signoff_page with has_signatures=True, signature_images length=2
2025-12-26 12:11:14,314 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] _create_signoff_page - Recalculated has_signatures: True, signature_images length: 2
2025-12-26 12:11:14,324 - Server_PM_Report.server_pm_pdf_generator - ERROR - Error generating PDF: name 'signature_images' is not defined
2025-12-26 12:11:14,332 - Server_PM_Report.server_pm_pdf_generator - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\Server_PM_Report\server_pm_pdf_generator.py", line 271, in generate_comprehensive_pdf
    story.extend(page_creator(component_title, component_data, processed_data))
                 ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\Server_PM_Report\server_pm_pdf_generator.py", line 625, in _create_server_health_page
    self._add_remarks_section(story, remarks_text)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\Server_PM_Report\server_pm_pdf_generator.py", line 2435, in _add_remarks_section
    actual_has_signatures = bool(signature_images and isinstance(signature_images, dict) and len(signature_images) > 0)
                                 ^^^^^^^^^^^^^^^^
NameError: name 'signature_images' is not defined

2025-12-26 12:11:14,333 - __main__ - ERROR - [STEP 8 FAILED] PDF generation failed
2025-12-26 12:11:14,333 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:11:14,334 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "ddf21461-7230-48dd-843e-9a71ee55ef3f",
  "status": "failed",
  "message": "PDF generation failed",
  "timestamp": "2025-12-26T12:11:14.333866"
}
2025-12-26 12:11:14,336 - __main__ - INFO - [STATUS UPDATE] ddf21461-7230-48dd-843e-9a71ee55ef3f -> FAILED - PDF generation failed
2025-12-26 12:11:14,338 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 12:11:14,339 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/ddf21461-7230-48dd-843e-9a71ee55ef3f
2025-12-26 12:13:31,381 - __main__ - INFO - 
2025-12-26 12:13:31,382 - __main__ - INFO - Cleaning up resources...
2025-12-26 12:13:31,463 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<main() done, defined at C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\main.py:835> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 712, in run_until_complete
    self.run_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 683, in run_forever
    self._run_once()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2012, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\windows_events.py", line 446, in select
    self._poll(timeout)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\windows_events.py", line 775, in _poll
    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 155, in _on_sigint
    self._loop.call_soon_threadsafe(lambda: None)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 884, in call_soon_threadsafe
    self._write_to_self()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\proactor_events.py", line 830, in _write_to_self
    csock.send(b'\0')
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\main.py", line 801, in start_service
    await asyncio.sleep(1)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\tasks.py", line 718, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\main.py", line 864, in <module>
    asyncio.run(main())
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 62, in __exit__
    self.close()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 206, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 712, in run_until_complete
    self.run_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 683, in run_forever
    self._run_once()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2050, in _run_once
    handle._run()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\main.py", line 839, in main
    await service.start_service()
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\main.py", line 810, in start_service
    await self.cleanup()
  File "C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\main.py", line 816, in cleanup
    logger.info("Cleaning up resources...")
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\logging\__init__.py", line 1520, in info
    self._log(INFO, msg, args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\logging\__init__.py", line 1665, in _log
    self.handle(record)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\logging\__init__.py", line 1681, in handle
    self.callHandlers(record)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\logging\__init__.py", line 1737, in callHandlers
    hdlr.handle(record)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\logging\__init__.py", line 1027, in handle
    self.emit(record)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\logging\__init__.py", line 1154, in emit
    stream.write(msg + self.terminator)
KeyboardInterrupt
2025-12-26 12:13:35,198 - __main__ - INFO - 
2025-12-26 12:13:35,199 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 12:13:35,200 - __main__ - INFO - 
2025-12-26 12:13:35,200 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 12:13:35,201 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 12:13:35,201 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 12:13:35,201 - __main__ - INFO - Authenticating with API...
2025-12-26 12:13:35,201 - __main__ - INFO - 
2025-12-26 12:13:35,201 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 12:13:35,226 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 12:13:35,227 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 12:13:35,593 - __main__ - INFO - 
2025-12-26 12:13:35,593 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 12:13:35,595 - __main__ - INFO - 
2025-12-26 12:13:35,595 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 12:13:35,596 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T04:13:35.5910636Z
2025-12-26 12:13:35,599 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 12:13:35,616 - __main__ - INFO - 
2025-12-26 12:13:35,617 - __main__ - INFO - 
2025-12-26 12:13:35,617 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 12:13:35,617 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 12:13:35,618 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 12:13:35,618 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 12:13:35,620 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 12:13:35,622 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 12:13:35,623 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 12:13:35,625 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 12:13:35,626 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 12:14:34,957 - __main__ - INFO - 
2025-12-26 12:14:34,958 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:14:34,958 - __main__ - INFO - [DATA] Message data: {'report_id': 'b6b5a998-f95c-4cbe-91d0-b236d744e8fe', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T04:14:34.9520295Z', 'report_type': 'server_pm_final_report'}
2025-12-26 12:14:34,963 - __main__ - INFO - 
2025-12-26 12:14:34,964 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: b6b5a998-f95c-4cbe-91d0-b236d744e8fe (server_pm_reportform_signature_pdf)
2025-12-26 12:14:34,964 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 12:14:34,965 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:14:34,966 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "b6b5a998-f95c-4cbe-91d0-b236d744e8fe",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T12:14:34.965492"
}
2025-12-26 12:14:34,968 - __main__ - INFO - [STATUS UPDATE] b6b5a998-f95c-4cbe-91d0-b236d744e8fe -> PROCESSING - PDF generation started
2025-12-26 12:14:34,968 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 12:14:34,969 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:14:34,970 - __main__ - INFO - 
2025-12-26 12:14:34,970 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 12:14:34,971 - __main__ - INFO - 
2025-12-26 12:14:34,972 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 12:14:34,973 - __main__ - INFO - 
2025-12-26 12:14:34,974 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:14:34,975 - __main__ - INFO - 
2025-12-26 12:14:34,976 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:14:35,130 - __main__ - INFO - 
2025-12-26 12:14:35,130 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 12:14:35,131 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 12:14:35,131 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 12:14:35,949 - __main__ - INFO - 
2025-12-26 12:14:35,950 - __main__ - INFO - [API] Response Status: 200
2025-12-26 12:14:35,951 - __main__ - INFO - 
2025-12-26 12:14:35,951 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3432 chars)
2025-12-26 12:14:35,952 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 12:14:35,954 - __main__ - INFO - 
2025-12-26 12:14:35,954 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 12:14:35,955 - __main__ - INFO - 
2025-12-26 12:14:35,955 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 12:14:35,956 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 12:14:36,181 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\Signatures\20251226_121434_b7ed7e0c05e045f3b4a636c369797c06.png
2025-12-26 12:14:36,182 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\Signatures\20251226_121434_1e3e9f5d14c9497981bb37aee70104d8.png
2025-12-26 12:14:36,184 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 12:14:36,184 - __main__ - INFO - 
2025-12-26 12:14:36,185 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-26 12:14:36,185 - __main__ - INFO - 
2025-12-26 12:14:36,185 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 12:14:36,186 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 12:14:36,187 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 12:14:36,187 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 12:14:36,190 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature detection - has_signatures: True
2025-12-26 12:14:36,192 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature images type: <class 'dict'>, length: 2
2025-12-26 12:14:36,192 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-26 12:14:36,194 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image values: ['C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\\Signatures\\20251226_121434_b7ed7e0c05e045f3b4a636c369797c06.png', 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\\Signatures\\20251226_121434_1e3e9f5d14c9497981bb37aee70104d8.png']
2025-12-26 12:14:36,194 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Calling _create_signoff_page with has_signatures=True, signature_images length=2
2025-12-26 12:14:36,195 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] _create_signoff_page - Recalculated has_signatures: True, signature_images length: 2
2025-12-26 12:14:36,209 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] has_signatures param: True, actual_has_signatures: True
2025-12-26 12:14:36,210 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] signature_images: {'ApprovedBySignature': 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\\Signatures\\20251226_121434_b7ed7e0c05e045f3b4a636c369797c06.png', 'AttendedBySignature': 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\\Signatures\\20251226_121434_1e3e9f5d14c9497981bb37aee70104d8.png'}, length: 2
2025-12-26 12:14:36,211 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Adding signature images section to final report
2025-12-26 12:14:36,212 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Building signature section with 2 signature images
2025-12-26 12:14:36,213 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-26 12:14:36,213 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] AttendedBySignature path: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\Signatures\20251226_121434_1e3e9f5d14c9497981bb37aee70104d8.png
2025-12-26 12:14:36,214 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] ApprovedBySignature path: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\Signatures\20251226_121434_b7ed7e0c05e045f3b4a636c369797c06.png
2025-12-26 12:14:36,214 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] AttendedBySignature exists: True
2025-12-26 12:14:36,215 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] ApprovedBySignature exists: True
2025-12-26 12:14:36,216 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Successfully loaded signature image: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\Signatures\20251226_121434_1e3e9f5d14c9497981bb37aee70104d8.png
2025-12-26 12:14:36,218 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Successfully loaded signature image: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b6b5a998-f95c-4cbe-91d0-b236d744e8fe\Signatures\20251226_121434_b7ed7e0c05e045f3b4a636c369797c06.png
2025-12-26 12:14:36,402 - Server_PM_Report.server_pm_pdf_generator - INFO - PDF generated successfully: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010001_20251226_121436.pdf
2025-12-26 12:14:36,402 - __main__ - INFO - 
2025-12-26 12:14:36,403 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010001_20251226_121436.pdf
2025-12-26 12:14:36,404 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:14:36,404 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "b6b5a998-f95c-4cbe-91d0-b236d744e8fe",
  "status": "completed",
  "message": "PDF generated successfully: Server_PM_FinalReport_Report_10010001_20251226_121436.pdf",
  "timestamp": "2025-12-26T12:14:36.404198",
  "file_name": "Server_PM_FinalReport_Report_10010001_20251226_121436.pdf"
}
2025-12-26 12:14:36,406 - __main__ - INFO - [STATUS UPDATE] b6b5a998-f95c-4cbe-91d0-b236d744e8fe -> COMPLETED - PDF generated successfully: Server_PM_FinalReport_Report_10010001_20251226_121436.pdf
2025-12-26 12:14:36,406 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 12:14:36,407 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/b6b5a998-f95c-4cbe-91d0-b236d744e8fe
2025-12-26 12:19:27,221 - __main__ - INFO - 
2025-12-26 12:19:27,221 - __main__ - INFO - Cleaning up resources...
2025-12-26 12:19:31,418 - __main__ - INFO - 
2025-12-26 12:19:31,419 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-26 12:19:31,421 - __main__ - INFO - 
2025-12-26 12:19:31,421 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-26 12:19:31,422 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-26 12:19:31,423 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-26 12:19:31,423 - __main__ - INFO - Authenticating with API...
2025-12-26 12:19:31,423 - __main__ - INFO - 
2025-12-26 12:19:31,423 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-26 12:19:31,445 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-26 12:19:31,445 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-26 12:19:31,792 - __main__ - INFO - 
2025-12-26 12:19:31,792 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-26 12:19:31,793 - __main__ - INFO - 
2025-12-26 12:19:31,793 - __main__ - INFO - [AUTH] Authentication successful
2025-12-26 12:19:31,794 - __main__ - INFO - [AUTH] Token expires at: 2025-12-27T04:19:31.7909827Z
2025-12-26 12:19:31,796 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-26 12:19:31,818 - __main__ - INFO - 
2025-12-26 12:19:31,819 - __main__ - INFO - 
2025-12-26 12:19:31,820 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-26 12:19:31,820 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-26 12:19:31,821 - __main__ - INFO - Waiting for MQTT messages...
2025-12-26 12:19:31,822 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-26 12:19:31,823 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-26 12:19:31,824 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-26 12:19:31,824 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-26 12:19:31,825 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-26 12:19:31,825 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-26 12:21:39,611 - __main__ - INFO - 
2025-12-26 12:21:39,612 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:21:39,612 - __main__ - INFO - [DATA] Message data: {'report_id': 'b174baf9-3fa5-43b7-999e-b6e5faed7b0c', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T04:21:39.6046445Z', 'report_type': 'server_pm_final_report'}
2025-12-26 12:21:39,618 - __main__ - INFO - 
2025-12-26 12:21:39,619 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: b174baf9-3fa5-43b7-999e-b6e5faed7b0c (server_pm_reportform_signature_pdf)
2025-12-26 12:21:39,619 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-26 12:21:39,619 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:21:39,620 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "b174baf9-3fa5-43b7-999e-b6e5faed7b0c",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T12:21:39.619923"
}
2025-12-26 12:21:39,621 - __main__ - INFO - [STATUS UPDATE] b174baf9-3fa5-43b7-999e-b6e5faed7b0c -> PROCESSING - PDF generation started
2025-12-26 12:21:39,622 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-26 12:21:39,623 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:21:39,623 - __main__ - INFO - 
2025-12-26 12:21:39,624 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-26 12:21:39,625 - __main__ - INFO - 
2025-12-26 12:21:39,625 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-26 12:21:39,627 - __main__ - INFO - 
2025-12-26 12:21:39,627 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:21:39,628 - __main__ - INFO - 
2025-12-26 12:21:39,629 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:21:39,750 - __main__ - INFO - 
2025-12-26 12:21:39,751 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 12:21:39,752 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 12:21:39,752 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 12:21:40,556 - __main__ - INFO - 
2025-12-26 12:21:40,557 - __main__ - INFO - [API] Response Status: 200
2025-12-26 12:21:40,558 - __main__ - INFO - 
2025-12-26 12:21:40,558 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 3435 chars)
2025-12-26 12:21:40,559 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 12:21:40,562 - __main__ - INFO - 
2025-12-26 12:21:40,562 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 12:21:40,563 - __main__ - INFO - 
2025-12-26 12:21:40,563 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-26 12:21:40,565 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-26 12:21:40,763 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\Signatures\20251226_122139_85d72fec37dd403287972ea32646d29e.png
2025-12-26 12:21:40,764 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\Signatures\20251226_122139_a60c8861366c4c3796846cb6fa9b2764.png
2025-12-26 12:21:40,765 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-26 12:21:40,766 - __main__ - INFO - 
2025-12-26 12:21:40,766 - __main__ - INFO - [STEP 7] Using job number: 10010001
2025-12-26 12:21:40,767 - __main__ - INFO - 
2025-12-26 12:21:40,767 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 12:21:40,768 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 12:21:40,768 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 12:21:40,769 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 12:21:40,772 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature detection - has_signatures: True
2025-12-26 12:21:40,773 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature images type: <class 'dict'>, length: 2
2025-12-26 12:21:40,773 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-26 12:21:40,774 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image values: ['C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\\Signatures\\20251226_122139_85d72fec37dd403287972ea32646d29e.png', 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\\Signatures\\20251226_122139_a60c8861366c4c3796846cb6fa9b2764.png']
2025-12-26 12:21:40,774 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Calling _create_signoff_page with has_signatures=True, signature_images length=2
2025-12-26 12:21:40,774 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] _create_signoff_page - Recalculated has_signatures: True, signature_images length: 2
2025-12-26 12:21:40,783 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] has_signatures param: True, actual_has_signatures: True
2025-12-26 12:21:40,783 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] signature_images: {'ApprovedBySignature': 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\\Signatures\\20251226_122139_85d72fec37dd403287972ea32646d29e.png', 'AttendedBySignature': 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\\Signatures\\20251226_122139_a60c8861366c4c3796846cb6fa9b2764.png'}, length: 2
2025-12-26 12:21:40,784 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Adding signature images section to final report
2025-12-26 12:21:40,784 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Building signature section with 2 signature images
2025-12-26 12:21:40,785 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-26 12:21:40,785 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] AttendedBySignature path: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\Signatures\20251226_122139_a60c8861366c4c3796846cb6fa9b2764.png
2025-12-26 12:21:40,786 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] ApprovedBySignature path: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\Signatures\20251226_122139_85d72fec37dd403287972ea32646d29e.png
2025-12-26 12:21:40,787 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] AttendedBySignature exists: True
2025-12-26 12:21:40,787 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] ApprovedBySignature exists: True
2025-12-26 12:21:40,788 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Successfully loaded signature image: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\Signatures\20251226_122139_a60c8861366c4c3796846cb6fa9b2764.png
2025-12-26 12:21:40,792 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Successfully loaded signature image: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\b174baf9-3fa5-43b7-999e-b6e5faed7b0c\Signatures\20251226_122139_85d72fec37dd403287972ea32646d29e.png
2025-12-26 12:21:40,966 - Server_PM_Report.server_pm_pdf_generator - INFO - PDF generated successfully: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010001_20251226_122140.pdf
2025-12-26 12:21:40,967 - __main__ - INFO - 
2025-12-26 12:21:40,967 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010001_20251226_122140.pdf
2025-12-26 12:21:40,968 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:21:40,969 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "b174baf9-3fa5-43b7-999e-b6e5faed7b0c",
  "status": "completed",
  "message": "PDF generated successfully: Server_PM_FinalReport_Report_10010001_20251226_122140.pdf",
  "timestamp": "2025-12-26T12:21:40.968494",
  "file_name": "Server_PM_FinalReport_Report_10010001_20251226_122140.pdf"
}
2025-12-26 12:21:40,970 - __main__ - INFO - [STATUS UPDATE] b174baf9-3fa5-43b7-999e-b6e5faed7b0c -> COMPLETED - PDF generated successfully: Server_PM_FinalReport_Report_10010001_20251226_122140.pdf
2025-12-26 12:21:40,971 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-26 12:21:40,972 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/b174baf9-3fa5-43b7-999e-b6e5faed7b0c
2025-12-26 12:24:56,474 - __main__ - INFO - 
2025-12-26 12:24:56,476 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 63ec3c8b-e054-4491-a006-7ce133082396
2025-12-26 12:24:56,476 - __main__ - INFO - [DATA] Message data: {'report_id': '63ec3c8b-e054-4491-a006-7ce133082396', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-26T04:24:56.4520490Z'}
2025-12-26 12:24:56,484 - __main__ - INFO - 
2025-12-26 12:24:56,485 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 63ec3c8b-e054-4491-a006-7ce133082396 (server_pm_reportform_pdf)
2025-12-26 12:24:56,486 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-26 12:24:56,487 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "63ec3c8b-e054-4491-a006-7ce133082396",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-26T12:24:56.486308"
}
2025-12-26 12:24:56,490 - __main__ - INFO - [STATUS UPDATE] 63ec3c8b-e054-4491-a006-7ce133082396 -> PROCESSING - PDF generation started
2025-12-26 12:24:56,491 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=9
2025-12-26 12:24:56,493 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-26 12:24:56,494 - __main__ - INFO - 
2025-12-26 12:24:56,495 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-26 12:24:56,496 - __main__ - INFO - 
2025-12-26 12:24:56,497 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-26 12:24:56,636 - __main__ - INFO - 
2025-12-26 12:24:56,637 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-26 12:24:56,638 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-26 12:24:56,638 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-26 12:24:57,498 - __main__ - INFO - 
2025-12-26 12:24:57,500 - __main__ - INFO - [API] Response Status: 200
2025-12-26 12:24:57,505 - __main__ - INFO - 
2025-12-26 12:24:57,508 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 2583 chars)
2025-12-26 12:24:57,513 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-26 12:24:57,529 - __main__ - INFO - 
2025-12-26 12:24:57,536 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-26 12:24:57,540 - __main__ - INFO - 
2025-12-26 12:24:57,552 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-26 12:24:57,575 - __main__ - INFO - 
2025-12-26 12:24:57,579 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-26 12:24:57,591 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-26 12:24:57,599 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-26 12:24:57,610 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-26 12:24:57,633 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature detection - has_signatures: False
2025-12-26 12:24:57,634 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature images type: <class 'dict'>, length: 0
2025-12-26 12:24:57,635 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Calling _create_signoff_page with has_signatures=False, signature_images length=0
2025-12-26 12:24:57,643 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] _create_signoff_page - Recalculated has_signatures: False, signature_images length: 0
2025-12-26 12:24:57,644 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] has_signatures param: False, actual_has_signatures: False
2025-12-26 12:24:57,645 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] signature_images: {}, length: 0
2025-12-26 12:24:57,646 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] No signatures found, using placeholder signatures only
2025-12-26 12:24:57,800 - Server_PM_Report.server_pm_pdf_generator - INFO - PDF generated successfully: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_Report_10010002_20251226_122457.pdf
2025-12-26 12:24:57,800 - __main__ - INFO - 
2025-12-26 12:24:57,801 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_Report_10010002_20251226_122457.pdf
2025-12-26 12:24:57,801 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-26 12:24:57,801 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "63ec3c8b-e054-4491-a006-7ce133082396",
  "status": "completed",
  "message": "PDF generated successfully: Server_PM_Report_10010002_20251226_122457.pdf",
  "timestamp": "2025-12-26T12:24:57.801508",
  "file_name": "Server_PM_Report_10010002_20251226_122457.pdf"
}
2025-12-26 12:24:57,803 - __main__ - INFO - [STATUS UPDATE] 63ec3c8b-e054-4491-a006-7ce133082396 -> COMPLETED - PDF generated successfully: Server_PM_Report_10010002_20251226_122457.pdf
2025-12-26 12:24:57,804 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=10
2025-12-26 12:24:57,804 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-27 21:37:52,522 - __main__ - WARNING - Unexpected MQTT disconnection. Attempting to reconnect...
2025-12-27 21:37:54,388 - __main__ - INFO - 
2025-12-27 21:37:54,452 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-27 21:37:54,555 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-27 21:37:54,694 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-27 21:37:54,804 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-27 21:37:54,889 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-27 21:37:55,011 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-27 21:37:55,088 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-31 10:26:50,298 - __main__ - INFO - 
2025-12-31 10:26:50,299 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2025-12-31 10:26:50,304 - __main__ - INFO - 
2025-12-31 10:26:50,305 - __main__ - INFO - Starting Server PM PDF Service...
2025-12-31 10:26:50,307 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2025-12-31 10:26:50,307 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2025-12-31 10:26:50,308 - __main__ - INFO - Authenticating with API...
2025-12-31 10:26:50,308 - __main__ - INFO - 
2025-12-31 10:26:50,309 - __main__ - INFO - [AUTH] Authenticating with API...
2025-12-31 10:26:50,400 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2025-12-31 10:26:50,401 - __main__ - INFO - [AUTH] Email: system@gmail.com
2025-12-31 10:26:51,084 - __main__ - INFO - 
2025-12-31 10:26:51,085 - __main__ - INFO - [AUTH] Response Status: 200
2025-12-31 10:26:51,086 - __main__ - INFO - 
2025-12-31 10:26:51,087 - __main__ - INFO - [AUTH] Authentication successful
2025-12-31 10:26:51,087 - __main__ - INFO - [AUTH] Token expires at: 2026-01-01T02:26:51.0786914Z
2025-12-31 10:26:51,091 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2025-12-31 10:26:51,101 - __main__ - INFO - 
2025-12-31 10:26:51,101 - __main__ - INFO - 
2025-12-31 10:26:51,102 - __main__ - INFO - Server PM PDF Service started successfully
2025-12-31 10:26:51,103 - __main__ - INFO - Connected to MQTT broker successfully
2025-12-31 10:26:51,104 - __main__ - INFO - Waiting for MQTT messages...
2025-12-31 10:26:51,106 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2025-12-31 10:26:51,107 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2025-12-31 10:26:51,109 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2025-12-31 10:26:51,110 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2025-12-31 10:26:51,112 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2025-12-31 10:26:51,113 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2025-12-31 10:27:05,897 - __main__ - INFO - 
2025-12-31 10:27:05,897 - __main__ - INFO - [STEP 1] Received MQTT message for report_id: 63ec3c8b-e054-4491-a006-7ce133082396
2025-12-31 10:27:05,898 - __main__ - INFO - [DATA] Message data: {'report_id': '63ec3c8b-e054-4491-a006-7ce133082396', 'requested_by': '11111111-1111-1111-1111-111111111111', 'timestamp': '2025-12-31T02:27:05.8912319Z', 'report_type': 'server_pm_final_report'}
2025-12-31 10:27:05,901 - __main__ - INFO - 
2025-12-31 10:27:05,902 - __main__ - INFO - [STEP 2] Starting PDF processing for report_id: 63ec3c8b-e054-4491-a006-7ce133082396 (server_pm_reportform_signature_pdf)
2025-12-31 10:27:05,902 - __main__ - INFO - [SIGNATURE] This is a signature-based final report request
2025-12-31 10:27:05,902 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-31 10:27:05,903 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "63ec3c8b-e054-4491-a006-7ce133082396",
  "status": "processing",
  "message": "PDF generation started",
  "timestamp": "2025-12-31T10:27:05.902845"
}
2025-12-31 10:27:05,903 - __main__ - INFO - [STATUS UPDATE] 63ec3c8b-e054-4491-a006-7ce133082396 -> PROCESSING - PDF generation started
2025-12-31 10:27:05,904 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=7
2025-12-31 10:27:05,904 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-31 10:27:05,904 - __main__ - INFO - 
2025-12-31 10:27:05,905 - __main__ - INFO - [STEP 3] Initializing database manager...
2025-12-31 10:27:05,905 - __main__ - INFO - 
2025-12-31 10:27:05,905 - __main__ - INFO - [STEP 4] Initializing Server PM PDF generator...
2025-12-31 10:27:05,906 - __main__ - INFO - 
2025-12-31 10:27:05,906 - __main__ - INFO - [STEP 5] Calling API endpoint /api/PMReportFormServer/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-31 10:27:05,907 - __main__ - INFO - 
2025-12-31 10:27:05,907 - __main__ - INFO - [API] URL: https://localhost:7145/api/PMReportFormServer/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-31 10:27:05,974 - __main__ - INFO - 
2025-12-31 10:27:05,974 - __main__ - INFO - [API] Making authenticated HTTP GET request...
2025-12-31 10:27:05,975 - __main__ - INFO - [API] Request timeout: 60 seconds
2025-12-31 10:27:05,975 - __main__ - INFO - [API] SSL verification disabled for localhost
2025-12-31 10:27:06,632 - __main__ - INFO - 
2025-12-31 10:27:06,633 - __main__ - INFO - [API] Response Status: 200
2025-12-31 10:27:06,635 - __main__ - INFO - 
2025-12-31 10:27:06,636 - __main__ - INFO - [API SUCCESS] Data retrieved successfully (Size: 25680 chars)
2025-12-31 10:27:06,637 - __main__ - INFO - [API] Response Keys: ['reportForm', 'pmReportFormServer', 'pmServerHealths', 'pmServerHardDriveHealths', 'pmServerDiskUsageHealths', 'pmServerCPUAndMemoryUsages', 'pmServerNetworkHealths', 'pmServerWillowlynxProcessStatuses', 'pmServerWillowlynxNetworkStatuses', 'pmServerWillowlynxRTUStatuses', 'pmServerWillowlynxHistoricalTrends', 'pmServerWillowlynxHistoricalReports', 'pmServerWillowlynxCCTVCameras', 'pmServerMonthlyDatabaseCreations', 'pmServerDatabaseBackups', 'pmServerTimeSyncs', 'pmServerHotFixes', 'pmServerFailOvers', 'pmServerASAFirewalls', 'pmServerSoftwarePatchSummaries']
2025-12-31 10:27:06,641 - __main__ - INFO - 
2025-12-31 10:27:06,642 - __main__ - INFO - [STEP 6] Transforming API data for report type server_pm_reportform_pdf...
2025-12-31 10:27:06,642 - __main__ - INFO - 
2025-12-31 10:27:06,643 - __main__ - INFO - [STEP 6.5] Fetching signature images for final report...
2025-12-31 10:27:06,643 - __main__ - INFO - [DB] Connecting to: WGN-009-530\SQLEXPRESS2022/ControlTowerDatabase
2025-12-31 10:27:06,940 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102705_c1dc5878eada4cddbf1bf215f57871b4.png
2025-12-31 10:27:06,940 - __main__ - INFO - [SIGNATURE] Found ApprovedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102626_329b2d17d0314915b7f88638eb53362c.png
2025-12-31 10:27:06,941 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102626_03368731b7f44568a4f7758ad4378aaa.png
2025-12-31 10:27:06,941 - __main__ - INFO - [SIGNATURE] Found AttendedBySignature: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102705_be8d6a34f534451b998a1c68f3f08939.png
2025-12-31 10:27:06,943 - __main__ - INFO - [SIGNATURE] Found 2 signature images
2025-12-31 10:27:06,943 - __main__ - INFO - 
2025-12-31 10:27:06,943 - __main__ - INFO - [STEP 7] Using job number: 10010002
2025-12-31 10:27:06,944 - __main__ - INFO - 
2025-12-31 10:27:06,944 - __main__ - INFO - [STEP 8] Generating PDF output...
2025-12-31 10:27:06,944 - Server_PM_Report.server_pm_pdf_generator - INFO - Converting API response data to JSON format...
2025-12-31 10:27:06,944 - Server_PM_Report.server_pm_pdf_generator - INFO - Parsing JSON data for PDF generation...
2025-12-31 10:27:06,945 - Server_PM_Report.server_pm_pdf_generator - INFO - JSON conversion and parsing completed successfully
2025-12-31 10:27:06,948 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature detection - has_signatures: True
2025-12-31 10:27:06,949 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature images type: <class 'dict'>, length: 2
2025-12-31 10:27:06,949 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-31 10:27:06,949 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image values: ['C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\63ec3c8b-e054-4491-a006-7ce133082396\\Signatures\\20251231_102626_329b2d17d0314915b7f88638eb53362c.png', 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\63ec3c8b-e054-4491-a006-7ce133082396\\Signatures\\20251231_102705_be8d6a34f534451b998a1c68f3f08939.png']
2025-12-31 10:27:06,950 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Calling _create_signoff_page with has_signatures=True, signature_images length=2
2025-12-31 10:27:06,950 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] _create_signoff_page - Recalculated has_signatures: True, signature_images length: 2
2025-12-31 10:27:06,971 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] has_signatures param: True, actual_has_signatures: True
2025-12-31 10:27:06,972 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] signature_images: {'ApprovedBySignature': 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\63ec3c8b-e054-4491-a006-7ce133082396\\Signatures\\20251231_102626_329b2d17d0314915b7f88638eb53362c.png', 'AttendedBySignature': 'C:\\Users\\thanthtet.myet\\Documents\\01_Willowglen\\03_ServiceReportSystem\\RMS_FileStorage\\63ec3c8b-e054-4491-a006-7ce133082396\\Signatures\\20251231_102705_be8d6a34f534451b998a1c68f3f08939.png'}, length: 2
2025-12-31 10:27:06,972 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Adding signature images section to final report
2025-12-31 10:27:06,972 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Building signature section with 2 signature images
2025-12-31 10:27:06,973 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Signature image keys: ['ApprovedBySignature', 'AttendedBySignature']
2025-12-31 10:27:06,973 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] AttendedBySignature path: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102705_be8d6a34f534451b998a1c68f3f08939.png
2025-12-31 10:27:06,973 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] ApprovedBySignature path: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102626_329b2d17d0314915b7f88638eb53362c.png
2025-12-31 10:27:06,974 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] AttendedBySignature exists: True
2025-12-31 10:27:06,974 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] ApprovedBySignature exists: True
2025-12-31 10:27:06,975 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Successfully loaded signature image: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102705_be8d6a34f534451b998a1c68f3f08939.png
2025-12-31 10:27:06,976 - Server_PM_Report.server_pm_pdf_generator - INFO - [Server PM PDF] Successfully loaded signature image: C:\Users\thanthtet.myet\Documents\01_Willowglen\03_ServiceReportSystem\RMS_FileStorage\63ec3c8b-e054-4491-a006-7ce133082396\Signatures\20251231_102626_329b2d17d0314915b7f88638eb53362c.png
2025-12-31 10:27:07,186 - Server_PM_Report.server_pm_pdf_generator - INFO - PDF generated successfully: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010002_20251231_102706.pdf
2025-12-31 10:27:07,186 - __main__ - INFO - 
2025-12-31 10:27:07,187 - __main__ - INFO - [STEP 8 SUCCESS] PDF generated successfully at: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File\Server_PM_FinalReport_Report_10010002_20251231_102706.pdf
2025-12-31 10:27:07,187 - __main__ - INFO - [MQTT] Publishing status to topic: controltower/server_pm_reportform_signature_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2025-12-31 10:27:07,188 - __main__ - INFO - [MQTT] Status message: {
  "report_id": "63ec3c8b-e054-4491-a006-7ce133082396",
  "status": "completed",
  "message": "PDF generated successfully: Server_PM_FinalReport_Report_10010002_20251231_102706.pdf",
  "timestamp": "2025-12-31T10:27:07.187719",
  "file_name": "Server_PM_FinalReport_Report_10010002_20251231_102706.pdf"
}
2025-12-31 10:27:07,188 - __main__ - INFO - [STATUS UPDATE] 63ec3c8b-e054-4491-a006-7ce133082396 -> COMPLETED - PDF generated successfully: Server_PM_FinalReport_Report_10010002_20251231_102706.pdf
2025-12-31 10:27:07,188 - __main__ - INFO - [MQTT] Publish result: rc=0, mid=8
2025-12-31 10:27:07,189 - __main__ - INFO - [MQTT] SUCCESS - Status published successfully to: controltower/server_pm_reportform_signature_pdf_status/63ec3c8b-e054-4491-a006-7ce133082396
2026-01-01 18:23:04,084 - __main__ - INFO - 
2026-01-01 18:23:04,084 - __main__ - INFO - Press 'r' + Enter at any time to refresh the PDF service.
2026-01-01 18:23:04,086 - __main__ - INFO - 
2026-01-01 18:23:04,086 - __main__ - INFO - Starting Server PM PDF Service...
2026-01-01 18:23:04,086 - __main__ - INFO - PDF output directory: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower_Python\PDF_Generator\PDF_File
2026-01-01 18:23:04,086 - __main__ - INFO - Image base path: C:\Temp\ReportFormImages
2026-01-01 18:23:04,087 - __main__ - INFO - Authenticating with API...
2026-01-01 18:23:04,087 - __main__ - INFO - 
2026-01-01 18:23:04,087 - __main__ - INFO - [AUTH] Authenticating with API...
2026-01-01 18:23:04,123 - __main__ - INFO - [AUTH] POST https://localhost:7145/api/Auth/signin
2026-01-01 18:23:04,123 - __main__ - INFO - [AUTH] Email: system@gmail.com
2026-01-01 18:23:04,606 - __main__ - INFO - 
2026-01-01 18:23:04,606 - __main__ - INFO - [AUTH] Response Status: 200
2026-01-01 18:23:04,607 - __main__ - INFO - 
2026-01-01 18:23:04,607 - __main__ - INFO - [AUTH] Authentication successful
2026-01-01 18:23:04,608 - __main__ - INFO - [AUTH] Token expires at: 2026-01-02T10:23:04.6019514Z
2026-01-01 18:23:04,609 - __main__ - INFO - Connecting to MQTT broker: localhost:1883
2026-01-01 18:23:04,637 - __main__ - INFO - 
2026-01-01 18:23:04,637 - __main__ - INFO - 
2026-01-01 18:23:04,637 - __main__ - INFO - Connected to MQTT broker successfully
2026-01-01 18:23:04,638 - __main__ - INFO - Server PM PDF Service started successfully
2026-01-01 18:23:04,638 - __main__ - INFO - Waiting for MQTT messages...
2026-01-01 18:23:04,639 - __main__ - INFO - Subscribed to topic: controltower/server_pm_reportform_pdf/+
2026-01-01 18:23:04,640 - __main__ - INFO - Subscribed to topic: controltower/cm_reportform_pdf/+
2026-01-01 18:23:04,640 - __main__ - INFO - Subscribed to topic: controltower/rtu_pm_reportform_pdf/+
2026-01-01 18:23:04,641 - __main__ - INFO - Subscribed to signature topic: controltower/cm_reportform_signature_pdf/+
2026-01-01 18:23:04,641 - __main__ - INFO - Subscribed to signature topic: controltower/server_pm_reportform_signature_pdf/+
2026-01-01 18:23:04,642 - __main__ - INFO - Subscribed to signature topic: controltower/rtu_pm_reportform_signature_pdf/+
2026-01-01 18:30:43,285 - __main__ - INFO - 
2026-01-01 18:30:43,285 - __main__ - INFO - Cleaning up resources...
